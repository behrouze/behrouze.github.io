{
    "componentChunkName": "component---src-templates-wp-post-tsx",
    "path": "/yarn-v3-vscode",
    "result": {"pageContext":{"id":"7b5325db-9f89-510f-991c-05fea3f92ea9","fileAbsolutePath":"/Users/behrouze/Sources/gatsby-blog/obsidian/Blog/yarn-v3-vscode.md","frontmatter":{"categories":["javascript"],"date":"2022-01-31","lastUpdate":"2022-01-31","tags":["vscode","yarn","wsl","node_modules"],"title":"yarn v3 et VSCode"},"html":"<p>Le passage de l'un de mes projets à <strong>Yarn V3</strong> (ultra rapide grâce a son <a href=\"https://yarnpkg.com/features/pnp\">Plug &#x26; Play</a>, <a href=\"https://yarnpkg.com/features/zero-installs#how-do-you-reach-this-zero-install-state-youre-advocating-for\">zéro install</a> et DX plus sympa que npm <a href=\"https://yarnpkg.com/getting-started/qa#why-should-you-upgrade-to-yarn-modern\">entre autres</a>) m'a fait perdre quelques heures précieuses à cause d'un problème lié au fait que <strong>Typescript</strong> utilise le dossier node_modules pour trouver les librairies installées.</p>\n<p>voir [[cheat-sheets|install yarn v3]]</p>\n<h1>VSCode ne trouve plus les modules installés</h1>\n<p>Voilà le résultat bien moche que j'ai obtenu suite à mon passage de npm vers Yarn v3 ☹ :\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 850px; box-shadow: 3px 5px 4px rgba(0,0,0,.1);margin:1rem;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/beea5f7a65de95023f0cf0a71ce796e3/f6f78/ts2307-yarn-v3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.187793427230048%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAx0lEQVQY01WPTW+DQAxE+f8/qj3nmvaGqogUIghedtfeTcJH+ipAStXD09gezUgufFSSd0RL+GhEtW22lEhm2Iu0qa6o7piR0n431S1TPMYJC0b0EeeuxDCQ1DMMA+f6Ql03NE1D27aICH3f03XdxroH7wk5E8YRL47iPk1MksmSkF7w4rmJIJeKU1Uhzm/B6+qFgOr+xaZRCSkTDgfi+xvn4/GvUMVwg5K7gdx+cw/C/LixPH9ezMvzP/PCDKSyZPz84FR+8Qu1kTBnbR47xAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/beea5f7a65de95023f0cf0a71ce796e3/bc663/ts2307-yarn-v3.webp 213w,\n/static/beea5f7a65de95023f0cf0a71ce796e3/8dc4f/ts2307-yarn-v3.webp 425w,\n/static/beea5f7a65de95023f0cf0a71ce796e3/10237/ts2307-yarn-v3.webp 850w,\n/static/beea5f7a65de95023f0cf0a71ce796e3/3b46e/ts2307-yarn-v3.webp 932w\"\n              sizes=\"(max-width: 850px) 100vw, 850px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/beea5f7a65de95023f0cf0a71ce796e3/3cb16/ts2307-yarn-v3.png 213w,\n/static/beea5f7a65de95023f0cf0a71ce796e3/2fbbf/ts2307-yarn-v3.png 425w,\n/static/beea5f7a65de95023f0cf0a71ce796e3/ae694/ts2307-yarn-v3.png 850w,\n/static/beea5f7a65de95023f0cf0a71ce796e3/f6f78/ts2307-yarn-v3.png 932w\"\n            sizes=\"(max-width: 850px) 100vw, 850px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/beea5f7a65de95023f0cf0a71ce796e3/ae694/ts2307-yarn-v3.png\"\n            alt=\"ts2307 yarn v3\"\n            title=\"ts2307 yarn v3\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>VSCode ne parvient plus a trouver ses modules avec à chaque import de module de package npm, des erreurs du type :\n<code class=\"language-text\">Cannot find module 'react' or its corresponding type declarations.ts(2307)</code></p>\n<h1>Solution</h1>\n<p>D'après la doc de Yarn:</p>\n<blockquote>\n<p>Smart IDEs (such as VSCode or IntelliJ) require special configuration for TypeScript to work when using <a href=\"https://yarnpkg.com/features/pnp\">Plug'n'Play installs</a>.</p>\n</blockquote>\n<p>Voici les étapes qui ont permis de résoudre cette erreur <code class=\"language-text\">ts2307</code>, notamment l'utiliation des <code class=\"language-text\">yarn sdks</code>:</p>\n<ul>\n<li>installer la dernière version de <strong>typescript en dev dependency</strong>(VSCode utilise par défaut une version embarquée de typescript qui n'est pas la dernière)</li>\n<li>générer le <strong>yarn base SDKs</strong> et les <strong>settings pour VSCode</strong> via un <code class=\"language-text\">yarn dlx</code>, en complément voir les <a href=\"https://yarnpkg.com/getting-started/editor-sdks\">yarn editor SDKs</a> et la <a href=\"https://yarnpkg.com/getting-started/editor-sdks#vscode\">procédure spécifique à VSCode</a></li>\n<li><strong>configurer VSCode</strong> pour utiliser ce dernier</li>\n</ul>\n<h2>Installations</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> -D typescript@latest\n<span class=\"token function\">yarn</span> dlx @yarnpkg/sdks vscode</code></pre></div>\n<p>cela va créer un dossier spécial  <code class=\"language-text\">.yarn/sdks/typescript</code> :\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 369px; box-shadow: 3px 5px 4px rgba(0,0,0,.1);margin:1rem;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2f29de9e083ed9922eee406270bde636/e0cdb/yarn-v3-sdk-typescript.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 128.63849765258215%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAYAAAC3g3x9AAAACXBIWXMAAA7CAAAOwgEVKEqAAAAEPUlEQVRIx4WV2W4cRRSG5zm4JFwgxBXiKeC1EFJQIIKXAEEUbpEVRBQrGGIbZ/FkxuOZnum1eqnqrXqdsfWhrrGNY5zk4uioq0uf/lNnGz1bphz7JWHgEyUSx3WJE4kfCE7nCxzXI81ybMchihNEGKHS1JxLlZp71nKF6/moNGM09QWWkCgpSfPCwAbAcDmMYhKpyIvS+OFcqXT7rRRpmiGlQoQhURQT5YrRvnXIs/kBKsuQaY7rC1aOi8pL2n5D3faUdYtuuivLygpdt8x8ixNvhh8LiiwjrTtGfy0OeLmaUKiEWkZI3zGWhb6xVLjoJKSIAlLfoYyF+c4Cj7zMcZPMqJVSUpQVIydwkaHPHzPBN7tL7u4cc/fRa+4/OeX+4xO+2hnz7e6K73ZX3Hticf+pzQ9Pbe49nhNXa6KiIytK864iihitXIdgecLXzxI++DHls58Enz9UfPl7wxc7mo8fltx5kHPnl4yPHuR8+HPGp7/mfPIw41h2wDn95py+PyMrKka+8BBhYGQXRcGho5gGCt8PULkmL6ut6Td9Vmi6fk233lC1LW27oazXjDzfxVotSNMUXdUkkSBYPCeKEuI4oW4adFWZf1urqAavt8B+s6EsM9ZNR1FrRgtrzmw+Q2Upha6RcUDsHiHC2NSYynJKXV1YvfVVTVFeANcb6qZlvT4jr0tGgfBJY58sVRRVg1QheTQmCGM8EZLmJbppKZsWfQHWN4Ftx3pzTtFoRra95LfnM3yVUWUF+XSM+3wf93hKtrDQjkuxXKFtxyi7FTgo3JyTDyF7nsP3f3vMkoI2DKn293m0O+X13hHh4QHewT/ERy9ojo4o6+adCvNBoR94xP6KNFUmJC0iOu8UuZjhjScEk+nW5gvT65fJuRU4KJzPZ7wcvzKFOTy6TBNCb0KU5nhhZEwW5VZdqW8FVhchF5cKh9JRSlE1PTJ0cSZ7hGGC6zjYtovvCzMY9LU3HLypw75H1w2bATgodFybxXKOVBJddyT+HHfxCkcoVp4gTrZTR6rsSt1lYffrNU3bmbP15oy6bRnZzorpyQQ5dEpZ41ovWNkWCy9l5sRmsjRDyVxTlxYalZUG2Ha9yXLXn1E1G0ZD24nQNwrbqmNnvMv+6RE6r0yX/FfU1Y2Qt29oFNaN6eWqvQAGwtuG3Pbo0ynKsbEc10zlWCqqa+Vys2y20N6EvN5cAf0rYD4ZE1kWlu3gOC7LlW0m+SXsJnALOjPZ7tdnN4B1hxZLpHBYuT5BIMweKS7K5W3AAXbprwEVumqptSBTAV4QmewO+yPLizegbwMO9iawbsmzAJUEOJ4gEMJss2E2DktL39J67wS2TcOf8wgnUgghzAgb1uYAGBKj3xPy/4BN3zI+dDidOLiBt1UXCDw/wPN8sztutt7bgVLS9h2v9mymL5Yslgts1zeLf76wCERoel2/R+G/AgeYrbhuCZgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2f29de9e083ed9922eee406270bde636/bc663/yarn-v3-sdk-typescript.webp 213w,\n/static/2f29de9e083ed9922eee406270bde636/2d760/yarn-v3-sdk-typescript.webp 369w\"\n              sizes=\"(max-width: 369px) 100vw, 369px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2f29de9e083ed9922eee406270bde636/3cb16/yarn-v3-sdk-typescript.png 213w,\n/static/2f29de9e083ed9922eee406270bde636/e0cdb/yarn-v3-sdk-typescript.png 369w\"\n            sizes=\"(max-width: 369px) 100vw, 369px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2f29de9e083ed9922eee406270bde636/e0cdb/yarn-v3-sdk-typescript.png\"\n            alt=\"yarn v3 sdk typescript\"\n            title=\"yarn v3 sdk typescript\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>Se positionner sur un fichier typescript (ex <code class=\"language-text\">.ts</code> ou <code class=\"language-text\">.tsx</code>) puis <code class=\"language-text\">CTRL + SHIT + P</code> et saisir <code class=\"language-text\">Typescript: Select Typescript version...</code> pour enfin sélectionner la version de Typescript présente dans le <code class=\"language-text\">Workspace</code> précédement installée :\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 850px; box-shadow: 3px 5px 4px rgba(0,0,0,.1);margin:1rem;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17.37089201877934%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAwUlEQVQI12XIO2oCURhA4dlQdpCQBVinTJVtBdKGIBYKKRVE0A2kUAcf89Ih/vfO/HcezJh4RBRSpPiKczzjSiSJSYKYTZSyCXcEUUooSmjcH3EEt7fLK5K8Zm9ynCrOFVhrEWPxqqaFsuRtvObpfcFLb8nzx4LOp/AwMNz35Z/HgXDXPfD6pcCJLCvIrFA3LV7VtvzkFf7WMPJTZqtvJn7KcB4znCeMV8IsUqahMo2uLj0JlLUU/B6PaFGieqBpas4sWdTqnXrmAgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b35cffc506ace67d246b846884e4edb8/bc663/vscode-typescript-workspace-version.webp 213w,\n/static/b35cffc506ace67d246b846884e4edb8/8dc4f/vscode-typescript-workspace-version.webp 425w,\n/static/b35cffc506ace67d246b846884e4edb8/10237/vscode-typescript-workspace-version.webp 850w,\n/static/b35cffc506ace67d246b846884e4edb8/88718/vscode-typescript-workspace-version.webp 922w\"\n              sizes=\"(max-width: 850px) 100vw, 850px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b35cffc506ace67d246b846884e4edb8/3cb16/vscode-typescript-workspace-version.png 213w,\n/static/b35cffc506ace67d246b846884e4edb8/2fbbf/vscode-typescript-workspace-version.png 425w,\n/static/b35cffc506ace67d246b846884e4edb8/ae694/vscode-typescript-workspace-version.png 850w,\n/static/b35cffc506ace67d246b846884e4edb8/6da96/vscode-typescript-workspace-version.png 922w\"\n            sizes=\"(max-width: 850px) 100vw, 850px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b35cffc506ace67d246b846884e4edb8/ae694/vscode-typescript-workspace-version.png\"\n            alt=\"vscode typescript workspace version\"\n            title=\"vscode typescript workspace version\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>\nPour bénéficier du <em>go to definition</em> (le bon vieux F12), il faut installer l'<a href=\"https://marketplace.visualstudio.com/items?itemName=arcanis.vscode-zipfs\">extension VSCode ZipFS</a>.</p>\n<h1>Liens</h1>\n<ul>\n<li>voici le <a href=\"https://stackoverflow.com/questions/39668731/what-typescript-version-is-visual-studio-code-using-how-to-update-it?answertab=votes#tab-top\">post SO</a> qui m'a mis sur la voie</li>\n<li>un autre post Medium intéressant sur un setup <a href=\"https://javascript.plainenglish.io/getting-started-with-yarn-3-and-typescript-125e7b537e6c\">Yarn3 Typescript</a></li>\n</ul>"}},
    "staticQueryHashes": ["1026020893","28434099","3153813225"]}