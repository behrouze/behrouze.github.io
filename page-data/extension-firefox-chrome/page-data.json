{
    "componentChunkName": "component---src-templates-wp-post-tsx",
    "path": "/extension-firefox-chrome",
    "result": {"pageContext":{"id":"852ec1ad-b80a-52bf-8009-ef7bd2200fcf","fileAbsolutePath":"/home/behrouze/Sources/blog/obsidian/Blog/extension-firefox-chrome.md","frontmatter":{"categories":["javascript"],"date":"2020-12-18","lastUpdate":"2022-02-07","tags":["chrome","extension","firefox","javascript","mozilla","web-extensions"],"title":"Extension Firefox/Chrome"},"html":"<p>Les extensions Firefox ou Chrome sont de <em>v√©ritables applications</em> qui <strong>augmentent les fonctionnalit√©s</strong> de nos navigateurs (voir le portail grand publique <a href=\"https://addons.mozilla.org/fr/firefox/\">AMO</a>), sont un type d‚Äô<a href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons\">add-ons</a> (ou modules) qui peuvent :</p>\n<ul>\n<li>nous apporter de l'outillage (ex <a href=\"https://addons.mozilla.org/en-US/firefox/addon/react-devtools/\">React dev tools</a> ou ce ‚ú® <a href=\"https://addons.mozilla.org/firefox/addon/humble-bundle-downloader/\">Humble Bundle Downloader</a> ‚ú®)</li>\n<li>ajouter des entr√©es dans le <em>menu contextuel</em> du navigateur</li>\n<li>ou encore modifier compl√®tement l'apparence visuel des sites visit√©s (ex l'extension <a href=\"https://addons.mozilla.org/fr/firefox/addon/darkreader/\">Dark Reader</a>)</li>\n</ul>\n<p>Le <a href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions\">d√©veloppement d‚Äôune extension</a> repose sur des technos web classique javascript/html/css et une API WebExtensions cross-browser (voir les 2 docs <a href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Browser_support_for_JavaScript_APIs\">MDN</a> et <a href=\"https://developer.chrome.com/docs/extensions/reference/\">Google</a>).</p>\n<h1>Compatibilit√© <strong>Firefox</strong> et Chrome</h1>\n<p>Il est possible d‚Äô√©crire des extensions cross-browser <em>compatibles</em> <strong>Firefox</strong> et <strong>Chrome</strong>.\nCela se fait simplement par la prise en charge du namespace chrome par Firefox‚Ä¶</p>\n<p>Il faut √©galement noter que le W3C a d√©clar√© en 2021 la <a href=\"https://www.w3.org/community/webextensions/2021/06/04/forming-the-wecg/\">cr√©ation d'un groupe de travail WECG</a>, la WebExtensions Community Group initi√©e par Mozilla, Google, Microsoft et Apple dans le but d'uniformiser les API et joindre les efforts :</p>\n<blockquote>\n<p>This <a href=\"https://www.w3.org/groups/#cgbg\">community group</a> seeks to align on a common vision for browser extensions and to work towards future standardization.</p>\n</blockquote>\n<h1>Le Workflow de d√©veloppement</h1>\n<p>Mozilla nous aide en documentant le <a href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Firefox_workflow_overview\">workflow</a> de d√©veloppement d'une extension:</p>\n<ol>\n<li>concevoir</li>\n<li>d√©velopper</li>\n<li>soumettre</li>\n<li>g√©rer la vie de l‚Äôextension</li>\n</ol>\n<h2>Point de d√©part</h2>\n<p><a href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions\">Le process de cr√©ation des extensions</a> est plutot bien document√©, et Mozilla fourni diff√©rents guides connexes (par ex <a href=\"https://design.firefox.com/photon/introduction/principles.html\">Photon Design System</a>, portail Mozilla est d√©di√© aux <em>best practices</em> et <em>design UI</em> des extension pour Firefox).</p>\n<p>üöÄ un conseil : d√©marrer avec <a href=\"https://extensionworkshop.com/documentation/develop/browser-extension-development-tools/\">cette page</a> qui pr√©sente tous les outils dispo comme notamment le <a href=\"https://webextensions.in/\">web-ext scaffolder</a> qui va vous g√©n√©rer un zip contenant les fichiers essentiel √† votre d√©veloppement.</p>\n<h2>La Big Picture</h2>\n<p>Le projet de d√©veloppement d‚Äôune extension doit √™tre compos√© des √©l√©ments suivants</p>\n<ul>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/manifest.json\">manifest.json</a> qui va <em>d√©crire l‚Äôextension</em>, ses <em>permissions</em> ainsi que ses <a href=\"https://developer.mozilla.org/fr/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension#rendre_accessible_des_ressources_web\">resources</a> : ic√¥nes, nom et points d‚Äôentr√©es etc</li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension#background_scripts\">page d'arri√®re-plan</a> : qui va permettre de conserver un √©tat (state) et g√©rer les donn√©es</li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension#sidebars_popups_options_pages\">composants de l'UI</a> de l'extension :\n<ul>\n<li>sidebars (barre lat√©rale comme celle de l'historique de Firefox)</li>\n<li>popups (choix entre <em>toolbar</em> ou <em>address bar</em>)</li>\n<li>options pages (<a href=\"https://www.youtube.com/watch?time_continue=12&#x26;v=eODy24csH5M&#x26;feature=emb_logo\">vid√©o</a>)</li>\n</ul>\n</li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension#extension_pages\">extension page</a> : page custom, non r√©f√©renc√©e dans le manifest et cr√©er via <a href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/windows/create\"><code class=\"language-text\">windows.create()</code></a> or <a href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs/create\"><code class=\"language-text\">tabs.create()</code></a>.</li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension#content_scripts\">content script</a> : permet d'interagir avec le DOM d‚Äôune page</li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension#web_accessible_resources\">resources</a> : les <em>images</em>, <em>html</em>, <em>js</em> et css <em>utilis√©s</em> au sein de l'extension par les content scripts et <a href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Sharing_objects_with_page_scripts\">page scripts</a></li>\n</ul>\n<p>voir <a href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension#sidebars_popups_and_options_pages\">Anatomie d'une WebExtension</a></p>\n<h1>web-ext</h1>\n<p>Avec <code class=\"language-text\">web-ext</code> Mozilla nous fourni un outil qui <strong>am√©liore le confort de d√©veloppement</strong> en nous √©vitant certaintes √©tapes manuelles comme le re/chargement d‚Äôextension‚Ä¶ (le fameux <code class=\"language-text\">about:debugging#/runtime/this-firefox</code>).</p>\n<h2>Installation</h2>\nL‚Äôinstallation de web-ext qui est un module <a href=\"/nvm-nodejs\" title=\"Nodejs\">Nodejs</a> s‚Äôeffectue avec un simple npm i -g web-ext et comporte comme pr√©-requis (pour web-ext v6):\n<ul>\n<li><a href=\"https://nodejs.org/en/\">Node.js</a>, 12.0.0 ou sup</li>\n<li><a href=\"https://www.npmjs.com/\">npm</a>, 6.9.0 ou sup</li>\n</ul>\n<h2>Run et debug</h2>\n<p>Il suffit ensuite le lancer en s√©lectionnant parmi ses options :</p>\n<h3>watch</h3>\n<p><code class=\"language-text\">web-ext run</code> : le mode <em>watcher</em> est le mode par d√©faut</p>\n<h3>console</h3>\n<p><code class=\"language-text\">web-ext run --browser-console</code> : permet d'ouvrir automatiquement la console pour debugger plus rapidement</p>\n<h3>un profil Firefox d√©di√©</h3>\n<p><code class=\"language-text\">web-ext run --firefox-profile nom_profile_firefox --keep-profile-changes</code></p>\n<p>le d√©veloppement d'extension plus que d'autres type de d√©veloppements requiert l'utilisation d'un environement Navigateur :</p>\n<ul>\n<li>propre sans parasitage par d'autres extensions, d'o√π l'interet d'utiliser un profil Firefox d√©di√©</li>\n<li>avec certains param√©trage (comme par ex etre automatiquement logg√©)</li>\n</ul>\n<p>Pour cela 2 options utiles :</p>\n<ul>\n<li><code class=\"language-text\">--firefox-profile xxx</code></li>\n<li><code class=\"language-text\">--keep-profile-changes</code></li>\n</ul>\n<p><code class=\"language-text\">nom_profile_firefox</code> le nom du profile courant se r√©cup√®re dans Firefox avec <code class=\"language-text\">about:profiles</code> et requiert parfois le chemin absolu üò≥</p>\n<h3>linting</h3>\n<p><code class=\"language-text\">web-ext lint</code> : une autre option bien utile est le <a href=\"https://extensionworkshop.com/documentation/develop/web-ext-command-reference/#web-ext-lint\">linter</a> qui va v√©rifier le manifest, les permissions et des incoh√©rences dans le projet (√† lancer avant de packager le projet)</p>\n<h3>build &#x26; sign</h3>\n<p>En fin de process il faudra finalement <strong>builder</strong> (packager) et <strong>signer</strong> son extension (<a href=\"https://extensionworkshop.com/documentation/develop/getting-started-with-web-ext/#packaging-your-extension\">voir doc</a>), ce qui va se faire avec les 2 options :</p>\n<ul>\n<li><code class=\"language-text\">web-ext build</code></li>\n<li><code class=\"language-text\">web-ext sign</code></li>\n</ul>\n<h3>combinaison</h3>\n<p>il est bien sur possible de combiner les options de lancement de <code class=\"language-text\">web-ext</code> :\n<code class=\"language-text\">web-ext run --browser-console --firefox-profile default-release</code></p>\n<h3>web-ext docs</h3>\n<p><code class=\"language-text\">web-ext docs</code> : pour ouvrir dans son navigateur par d√©faut la page de <a href=\"https://extensionworkshop.com/documentation/develop/web-ext-command-reference/\">doc</a></p>\n<p><code class=\"language-text\">web-ext --help</code> :</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">npx web-ext --help\nUsage: web-ext <span class=\"token punctuation\">[</span>options<span class=\"token punctuation\">]</span> <span class=\"token builtin class-name\">command</span>\n\nOption values can also be <span class=\"token builtin class-name\">set</span> by declaring an environment variable prefixed\nwith <span class=\"token variable\">$WEB_EXT_</span><span class=\"token builtin class-name\">.</span> For example: <span class=\"token variable\">$WEB_EXT_SOURCE_DIR</span><span class=\"token operator\">=</span>/path is the same as\n--source-dir<span class=\"token operator\">=</span>/path.\n\nTo view specific <span class=\"token builtin class-name\">help</span> <span class=\"token keyword\">for</span> any given command, <span class=\"token function\">add</span> the <span class=\"token builtin class-name\">command</span> name.\nExample: web-ext --help run.\n\n\nCommandes <span class=\"token builtin class-name\">:</span>\n  web-ext build  Create an extension package from <span class=\"token builtin class-name\">source</span>\n  web-ext sign   Sign the extension so it can be installed <span class=\"token keyword\">in</span> Firefox\n  web-ext run    Run the extension\n  web-ext lint   Validate the extension <span class=\"token builtin class-name\">source</span>\n  web-ext docs   Open the web-ext documentation <span class=\"token keyword\">in</span> a browser\n\nOptions <span class=\"token builtin class-name\">:</span></code></pre></div>\n<h1>Liens</h1>\n<h2>Docs</h2>\n<ul>\n<li>Page d'<a href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions\">intro MDN</a></li>\n<li><a href=\"https://developer.mozilla.org/fr/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension\">Anatomie</a> üß† d‚Äôune extension Firefox</li>\n<li>L'outil de g√©n√©ration de projet <a href=\"https://webextensions.in/\">webextensions.in</a></li>\n<li>liste des <a href=\"https://developer.mozilla.org/fr/docs/Mozilla/Add-ons/WebExtensions/API\">API WebExtensions</a> et <a href=\"https://developer.mozilla.org/fr/docs/Mozilla/Add-ons/WebExtensions/Compatibilit%C3%A9_navigateurs_API_JavaScript\">tableau de compatibilit√©</a> entre navigateurs</li>\n<li>comment <a href=\"https://extensionworkshop.com/documentation/develop/debugging/\">debugger</a> üêõ les <em>diff√©rents types d‚Äôextensions</em></li>\n<li>comment <a href=\"https://extensionworkshop.com/documentation/publish/\">faire signer une extension</a>, üìÑ validation par Mozilla</li>\n<li><a href=\"https://github.com/mozilla/webextension-polyfill#webextension-browser-api-polyfill--\">polyfill</a> pour utiliser les <em>Promises</em> sur <em>Chromium</em></li>\n<li><a href=\"https://extensionworkshop.com/documentation/develop/build-a-secure-extension/\">Best Practices de s√©curit√©</a></li>\n<li>Documentation <a href=\"https://developer.chrome.com/docs/extensions/\">Chrome Developers</a></li>\n</ul>\n<h2>Exemples de code</h2>\n<ul>\n<li><a href=\"https://github.com/mdn/webextensions-examples\">Mozilla</a> et leurs <a href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Examples\">index</a> (mapping entre exemples et API JavaScript utilis√©s)</li>\n<li><a href=\"https://github.com/GoogleChrome/chrome-extensions-samples\">Google Chrome Extensions</a> (ex: gmail, <a href=\"https://github.com/GoogleChrome/chrome-extensions-samples/blob/master/extensions/gmail/background.js\">ic√¥ne avec compteur</a>)</li>\n</ul>\n<h2>Vid√©os</h2>\n<ul>\n<li><a href=\"https://www.youtube.com/watch?v=Jxe7AXgbYqY\">Browser Extensions</a> par Matt Claypotch √† la JSConf US 2018 (33 min)</li>\n<li><a href=\"https://www.youtube.com/watch?v=a0_OsLGI0k4\">Tips for great content and design for your extension</a> (3 min)</li>\n<li><a href=\"https://www.youtube.com/watch?v=Q3AQ5D2QFwc\">How to build an extension for Firefox in less than 5 minutes</a> (5 min)</li>\n</ul>"}},
    "staticQueryHashes": ["1026020893","28434099","3153813225"]}