{
    "componentChunkName": "component---src-templates-wp-post-tsx",
    "path": "/ssh-tips-tricks",
    "result": {"pageContext":{"id":"dbe9912b-345c-5d43-be33-7a10499cc133","fileAbsolutePath":"/Users/behrouze/Sources/gatsby-blog/obsidian/Blog/ssh-tips-tricks.md","frontmatter":{"categories":["linux"],"date":"2018-08-26","lastUpdate":"2022-03-08","tags":["admin-linux","linux","memo","ssh","tips"],"title":"SSH tips & tricks"},"html":"<h1>Générer une pair de clé publique/privée SSH</h1>\n<h2>ssh-keygen</h2>\n<p>Pour bénéficier d'une authentification forte (<a href=\"https://blog.g3rt.nl/upgrade-your-ssh-keys.html\">lire ce post</a>) :</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">ssh-keygen -o -a <span class=\"token number\">100</span> -t ed25519</code></pre></div>\n<p>Le nom de cette clé ne sera peut être pas reconnu automatiquement par le client ssh, il peut alors etre utile de modifier son fichier <code class=\"language-text\">~/.ssh/config</code>  (<code class=\"language-text\">man ssh_config</code> ) pour y spécifier la nouvelle clé par défaut avec la directive:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">IdentityFile ~/.ssh/id_ed25519</code></pre></div>\n<h2>Modifier la passphrase SSH</h2>\n<p>Pour <strong>modifier</strong> ou <strong>supprimer</strong> la passphrase lié à la clé SSH privée (celle qui est en locale et qui nous sert à s'authentifier sur les serveur distant):</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">ssh-keygen -p <span class=\"token punctuation\">[</span>-P old_passphrase<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>-N new_passphrase<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>-f keyfile<span class=\"token punctuation\">]</span></code></pre></div>\n<h1>Diffuser sa clé publique via SSH</h1>\n<p>Dans le cas particulier de la <strong>copie de notre clé publique ssh</strong> sur une autre machine, une commande forte utile est <code class=\"language-text\">ssh-copy-id</code>  (demande le password):</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">ssh-copy-id username@destination</code></pre></div>\n<h1>Exécution distant parallélisée</h1>\n<ul>\n<li><a href=\"Blog/ansible.md\">Ansible</a> : logiciel de gestion de configurations qui permet d'<a href=\"https://ripplemotion.fr/comprendre-lindustrialisation-logicielle/\">industrialiser</a> le déploiement des applications sur des <em>serveurs ssh</em></li>\n<li><a href=\"https://github.com/robinbowes/pssh\">parallel-ssh</a> (Parallel versions of SSH-based tools): regroupe un ensemble de commandes (<code class=\"language-text\">pssh</code>, <code class=\"language-text\">pscp</code>, <code class=\"language-text\">prsync</code>, <code class=\"language-text\">pnuke</code>, and <code class=\"language-text\">pslurp</code>) permettant d'exécuter les même commandes sur plusieurs machines distantes.</li>\n<li><a href=\"http://docs.fabfile.org\">Fabric</a> (Simple Pythonic remote deployment tool): outil contrôlable via un script python (article sur l'<a href=\"https://gist.github.com/DavidWittman/1886632#using-fabric\">usage</a> puis sur <a href=\"https://www.linuxjournal.com/content/fabric-system-administrators-best-friend\">Linuxjournal</a> et <a href=\"https://insights.sei.cmu.edu/devops/2015/03/devops-technologies-fabric-or-ansible.html\">un autre</a> sur plus général sur les outils devops)</li>\n</ul>\n<h1>Copie de fichiers via SSH</h1>\n<p>Il est possible d'utiliser une <strong>connexion SSH</strong> pour copier un fichier entre 2 machines du réseau de façon sécurisée avec <code class=\"language-text\">scp</code> et son <a href=\"https://winscp.net/eng/docs/lang:fr\">homologue pour Windows</a> <code class=\"language-text\">WinScp</code> ou <code class=\"language-text\">pscp.exe</code> PuTTY Secure Copy client de la <a href=\"https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html\">suite Putty</a>.</p>\n<h2>Télécharger</h2>\n<p>Pour copier d'un serveur <strong>SSH distant vers</strong> un répertoire <strong>local</strong> :</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">scp</span> username_distant@nom_du_serveur_ssh_distant:/dossier_distant/fichier_distant /dossier_distant/tmp/</code></pre></div>\n<h2>Uploader</h2>\n<p>Dans l'autre sens, <strong>local vers serveur SSH distant</strong> :</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">scp</span> /dossier_local/fichier_local username_distant@nom_du_serveur_ssh_distant:/dossier_distant/</code></pre></div>\n<h1>Liens</h1>\n<p><a href=\"https://linux-audit.com/audit-and-harden-your-ssh-configuration/\">Renforcer la sécurité de son serveur SSHD</a>\nProxyfier SSH avec <a href=\"http://www.rutschle.net/tech/sslh/README.html\">SSLH</a> ou <a href=\"https://www.squins.com/knowledge/squid-http-https-ssh-proxy/\">Squid</a></p>"}},
    "staticQueryHashes": ["1026020893","28434099","3153813225"]}