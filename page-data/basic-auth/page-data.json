{"componentChunkName":"component---src-templates-wp-post-tsx","path":"/basic-auth","result":{"pageContext":{"id":"b1f1b646-8788-54cd-819b-fba9c9ca4c10","fileAbsolutePath":"/Users/behrouze/Sources/gatsby-blog/obsidian/Blog/basic-auth.md","frontmatter":{"categories":["securite"],"date":"2019-08-11","lastUpdate":null,"tags":["net","http","reseau","securite","base64","basicauth"],"title":"Basic Auth"},"html":"<p>La <strong>Basic Auth</strong> (Basic Authentication en ğŸ‡¬ğŸ‡§) ou <a href=\"https://developer.mozilla.org/fr/docs/Web/HTTP/Authentication#sch%C3%A9ma_dauthentification_basique\">SchÃ©ma d'Authentification Basique</a> en ğŸ‡«ğŸ‡· <a href=\"https://tools.ietf.org/html/rfc7617#section-2\">RFC7617</a> est l'un des <a href=\"https://developer.mozilla.org/fr/docs/Web/HTTP/Authentication#sch%C3%A9ma_dauthentification\">schÃ©ma</a> d'<a href=\"https://developer.mozilla.org/fr/docs/Web/HTTP/Authentication\">authentification HTTP</a> de la \"structure dâ€™<a href=\"https://fr.wikipedia.org/wiki/Authentification_HTTP\">authentification HTTP</a>\"\nElle permet de protÃ©ger une URL par un simple couple <strong>login/mot de passe</strong>.\nLors de l'accÃ¨s Ã  une <em>URL protÃ©gÃ©e par une Basic Auth</em>, le navigateur fait apparaÃ®tre une <strong>pop-up</strong> demandant les credentials (login/pass).</p>\n<h1>Lâ€™utiliser ou pas ?</h1>\n<p>Ce mÃ©canisme permet de mettre en place un <strong>blocage simple</strong>, mais elle est si basique quâ€™elle peut Ãªtre sniffÃ©e si certaines requÃªtes ne passent en https car les <em>login</em> et <em>password</em> sont juste <strong>encodÃ©s en base64</strong> ou simplement brute forcÃ©e (si dâ€™autres mÃ©canismes de limitations ne sont pas en place).</p>\n<ul>\n<li>la basic auth est donc <strong>dÃ©conseillÃ©e</strong> ğŸ‘ pour sÃ©curiser lâ€™accÃ¨s Ã  une application web</li>\n<li>en revanche elle est <strong>adaptÃ©e</strong> ğŸ‘ dans le cas oÃ¹ on souhaite simplement cacher une URL des <a href=\"https://deviceatlas.com/blog/most-active-bots-and-crawlers-web\">crawlers</a> (Googlebot etc) pour par exemple Ã©viter lâ€™indexation des sites (environemens de recette, prÃ©-prod etc)</li>\n</ul>\n<h1>Protocole et en-tÃªtes HTTP</h1>\n<p>La sÃ©curisation par lâ€™authentification basique <strong>peut se faire Ã  diffÃ©rents niveaux</strong> de lâ€™infrastructure, soit au niveau des :</p>\n<ul>\n<li><strong>Reverse Proxy</strong> (Nginx, Apache) et mÃªme certains CDN qui proposent des fonctionnalitÃ©s de Proxy comme <a href=\"https://community.akamai.com/customers/s/article/How-To-Setup-HTTP-Basic-Authentication-on-Akamai\">Akamai</a></li>\n<li><strong>serveur web</strong> <a href=\"https://docs.nginx.com/nginx/admin-guide/security-controls/configuring-http-basic-authentication/\">Nginx</a>, Apache, IIS</li>\n<li><strong>application web</strong> via des framework comme <a href=\"https://github.com/jshttp/basic-auth/blob/master/README.md\">Express</a>, <a href=\"https://docs.microsoft.com/fr-fr/aspnet/web-api/overview/security/basic-authentication\">.Net</a></li>\n</ul>\n<h2>SÃ©quencement</h2>\n<ol>\n<li>le navigateur commence par effectuer un <code class=\"language-text\">http GET</code> lâ€™URL protÃ©gÃ©e par une Basic Auth</li>\n<li>en fonction de lâ€™infra qui authentifie (reverse proxy ou serveur web), on reÃ§oit cotÃ© client un couple <em>en-tÃªte HTTP</em> / <a href=\"https://developer.mozilla.org/fr/docs/Web/HTTP/Status#R%C3%A9ponses_d&#x27;erreur_c%C3%B4t%C3%A9_client\">code HTTP</a> diffÃ©rent, mais le schÃ©ma dâ€™authentification est dÃ©fini au niveau de ces en-tÃªtes (ici <code class=\"language-text\">Basic</code>):\n<ul>\n<li>du <strong>Proxy</strong> qui rÃ©pond avec :\n<ol>\n<li>code HTTP <strong><code class=\"language-text\">407</code></strong> (Proxy Authentication Required)</li>\n<li>en-tÃªte HTTP : <code class=\"language-text\">Proxy-Authenticate: Basic realm=\"Acces restreint\"</code></li>\n</ol>\n</li>\n<li>ou du <strong>serveur Web</strong> qui rÃ©pond avec :\n<ol>\n<li>code HTTP <strong><code class=\"language-text\">401</code></strong> (Unauthorized)</li>\n<li>en-tÃªte HTTP : <code class=\"language-text\">WWW-Authenticate: Basic realm=\"Acces restreint\"</code></li>\n</ol>\n</li>\n</ul>\n</li>\n<li>la <strong>pop-up</strong> dâ€™authentification sâ€™affiche alors dans le Navigateur<br>\n(lâ€™authentification Ã  travers lâ€™URL <a href=\"http://login:pass@exemple.com\">http://login:pass@exemple.com</a> est <a href=\"https://developer.mozilla.org/fr/docs/Web/HTTP/Status#R%C3%A9ponses_d&#x27;erreur_c%C3%B4t%C3%A9_client\">dÃ©prÃ©ciÃ©e</a>)</li>\n<li>le navigateur <strong>encode en base64</strong> la chaÃ®ne: Â«Â <code class=\"language-text\">login:pass</code>Â Â» et la transmet via un GET (de la mÃªme ressource) avec lâ€™en-tÃªte HTTP <code class=\"language-text\">Authorization</code><br>\nex: <code class=\"language-text\">Authorization: Basic bG9naW46cGFzcw==</code></li>\n<li>le Proxy ou Serveur Web qui gÃ¨re lâ€™authentification rÃ©ponds aprÃ¨s vÃ©rification, soit par une <strong><code class=\"language-text\">200</code></strong> (et tout roule), soit par une <code class=\"language-text\">**403**</code> (Forbidden)â€¦</li>\n<li>le <strong>navigateur garde en cache</strong> ces credentials et <strong>les envois lors de toutes les requÃªtes</strong> HTTP vers ce <code class=\"language-text\">realm</code> (ici la chaine <em>Acces restreint</em>)</li>\n<li>lorsque lâ€™<strong>onglet est fermÃ©</strong>, le navigateur <strong>supprime</strong> ces credentials de son <strong>cache</strong></li>\n</ol>\n<h1>Encodage et dÃ©codage</h1>\n<p>L'encodage</p>\n<h2>Nodejs:</h2>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">Buffer<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>b64<span class=\"token punctuation\">,</span> â€˜base64â€™<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><a href=\"https://nodejs.org/api/buffer.html#buffer_buffer\">https://nodejs.org/api/buffer.html#buffer_buffer</a></p>\n<h2>Navigateur:</h2>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">atob</span><span class=\"token punctuation\">(</span>b64<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><a href=\"https://developer.mozilla.org/fr/docs/Web/API/WindowOrWorkerGlobalScope#Methods\">https://developer.mozilla.org/fr/docs/Web/API/WindowOrWorkerGlobalScope#Methods</a></p>\n<h1>Express</h1>\n<p><a href=\"https://www.npmjs.com/package/basic-auth\">basic-auth</a> est un middleware Express (Nodejs) qui implÃ©mentent la Basic Auth.</p>"}},"staticQueryHashes":["1026020893","2750442709","28434099"]}