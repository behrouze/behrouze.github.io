{
    "componentChunkName": "component---src-templates-wp-post-tsx",
    "path": "/ufw",
    "result": {"pageContext":{"id":"992b4261-1bce-59ac-a31b-8b15dde196af","fileAbsolutePath":"/Users/behrouze/Sources/gatsby-blog/obsidian/Blog/ufw.md","frontmatter":{"categories":["linux"],"date":"2017-11-05","lastUpdate":"2022-02-14","tags":["firewall","iptables","linux","securite","ssh","ufw"],"title":"UFW un simple Firewall sous Linux"},"html":"<p>Un firewall (pare-feu) permet de bloquer les tentatives d'accès à des combinaisons de ports/protocoles que nous définissons.</p>\n<p>Par exemple, il est possible d'autoriser les connexions ssh uniquement depuis certaines adresses IP. UFW a été conçu pour simplifier la mise en place d'un Firewall iptables sous Linux, qui est relativement complexe a configurer... C'est donc une interface simple a utiliser, qui va créer les règles iptables sous-jacentes.</p>\n<h2>Installation</h2>\n<p>L'installation se fait par un simple <code class=\"language-text\">sudo sh -c \"apt update &amp;&amp; apt install ufw -y\"</code>. Le firewall est installé mais désactivé suite à l'installation, ce qui nous laisse le temps de le configurer avant de l'activer (et de se retrouver bloquer si on ne fait pas attention à débloquer le ssh ? )</p>\n<p>Par défaut les règles suivantes sont implémentées, bloquant les flux entrant et autorisant tout les flux sortant (de notre machine):</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">ufw default deny incoming\nufw default allow outgoing</code></pre></div>\n<h2>Les commandes de base</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># lister les règles en place</span>\nufw status verbose\n\n<span class=\"token comment\"># autoriser un protocole en spécifiant son nom</span>\nufw allow <span class=\"token function\">ssh</span>\nufw allow <span class=\"token keyword\">in</span> <span class=\"token number\">22</span>/tcp\n\n<span class=\"token comment\"># supprimer une règle</span>\nufw delete allow <span class=\"token keyword\">in</span> <span class=\"token number\">22</span>/tcp\n\n<span class=\"token comment\"># pour autoriser une adresse IP</span>\nufw allow from <span class=\"token number\">192.168</span>.0.1\n\n<span class=\"token comment\"># pour autoriser une plage de Ports</span>\nufw allow out <span class=\"token number\">6880</span>:6999/tcp</code></pre></div>\n<h2>Gestion</h2>\n<p>Il est possible d'afficher sous une forme de liste numérotée, l'ensemble des règles pour ensuite supprimer par numéro de ligne :</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ufw status numbered\nufw delete &lt;numéro-de-la-règle></code></pre></div>\n<h2>Spécifique</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># autoriser ssh depuis le réseau local uniquement</span>\nufw allow from <span class=\"token number\">192.168</span>.0.1/24 to any port <span class=\"token number\">22</span>\n\n<span class=\"token comment\"># autoriser http et https</span>\nufw allow proto tcp from any to any port <span class=\"token number\">80,443</span>\n\n<span class=\"token comment\"># autorise nginx sur en IPV4 et IPV6 sur 80 et 443</span>\nufw allow <span class=\"token string\">'Nginx Full'</span></code></pre></div>\n<h2>Logs</h2>\n<p>Il est bien entendu possible de logger l'activité de notre Firewall dans des fichiers (se trouveront par défaut dans <code class=\"language-text\">/var/log/ufw.log</code>) ou dans un rsyslog:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># activer a journalisation les fichiers de log</span>\nufw logging on\n\n<span class=\"token comment\"># ou encore en spécifiant le niveau de logs</span>\nufw <span class=\"token punctuation\">[</span>--dry-run<span class=\"token punctuation\">]</span> logging on<span class=\"token operator\">|</span>off<span class=\"token operator\">|</span>LEVEL  <span class=\"token comment\"># LEVEL => 'off', 'low', 'medium', 'high' and 'full'</span></code></pre></div>\n<h2>Controle du Firewall</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">systemctl status ufw\n\n<span class=\"token comment\"># activer/désactiver le firewall</span>\nufw <span class=\"token builtin class-name\">enable</span>\nufw disable\n\n<span class=\"token comment\"># pour recharger la configuration qui vient d’être modifiée</span>\nufw reload \n\n<span class=\"token comment\"># pour un reset complet des règles</span>\nufw reset</code></pre></div>\n<h2>Liens</h2>\n<ul>\n<li>doc <a href=\"https://www.digitalocean.com/community/tutorials/ufw-essentials-common-firewall-rules-and-commands-fr\">Digital Ocean</a></li>\n<li>la <a href=\"https://doc.ubuntu-fr.org/ufw\">doc Ubuntu de UFW</a></li>\n<li>article sur les <a href=\"https://doc.ubuntu-fr.org/ufw\">Firewall nouvelles génération</a></li>\n<li>config avec <a href=\"https://zaiste.net/intro_fail2ban_with_ufw/\">UFW et  Fail2ban</a></li>\n</ul>"}},
    "staticQueryHashes": ["1026020893","1333896537","28434099"]}