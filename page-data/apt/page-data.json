{
    "componentChunkName": "component---src-templates-wp-post-tsx",
    "path": "/apt",
    "result": {"pageContext":{"id":"d73e307f-1742-5a0d-a761-cfb8f2dd9c0c","fileAbsolutePath":"/Users/behrouze/Sources/gatsby-blog/obsidian/Blog/apt.md","frontmatter":{"categories":["devops"],"date":"2019-08-18","lastUpdate":"2022-03-22","tags":["bash","linux","raspberry-pi","shell","ubuntu","apt","cli"],"title":"APT"},"html":"<p><em><a href=\"https://web.archive.org/web/20200923133925/https://debian-handbook.info/browse/fr-FR/stable/sect.apt-get.html\">apt</a></em> l‚Äô<em><strong>A</strong>dvanced <strong>P</strong>ackaging <strong>T</strong>ool</em> (<em>outil de paquetage avanc√©</em>) est un outil en <strong>CLI</strong> pr√©sent sur les syst√®mes √† base de Linux Debian (Ubuntu, Raspbian, Kali etc.) qui permet de chercher, d‚Äôinstaller ou de mettre √† jour des programmes/applications packag√©s (fichiers archives ou <a href=\"https://web.archive.org/web/20200923133925/https://www.debian.org/doc/manuals/debian-reference/ch02.fr.html\">packages .deb</a>) sur nos syst√®mes d‚Äôexploitations.</p>\n<h1>apt et apt-get</h1>\n<p><code class=\"language-text\">apt</code> succ√®de √† <a href=\"https://debian-handbook.info/browse/fr-FR/stable/sect.manipulating-packages-with-dpkg.html\">dpkg</a> qui est de plus bas niveau et sur lequel il repose, <code class=\"language-text\">apt</code> <em>g√®re les d√©pendances</em> (installe par exemple les pr√©-requis).</p>\n<h1>apt-get pour le scripting</h1>\n<p>Les <strong>scripts</strong> shell devraient <strong>plut√¥t</strong> utiliser <code class=\"language-text\">apt-get</code> qu‚Äô<code class=\"language-text\">apt</code> pour √©viter de rencontrer des erreurs dues au formatage de la sortie d‚Äô<code class=\"language-text\">apt</code> (<a href=\"https://askubuntu.com/questions/990823/apt-gives-unstable-cli-interface-warning\">voir ce SO</a>), car en effet <code class=\"language-text\">apt</code> a √©t√© con√ßu pour apporter des informations plus claires √† l‚Äôutilisateur en mode interactif (ex. barre d‚Äôavancement).<br>\nCela nous est signal√© par le message suivant si on utilise <code class=\"language-text\">apt</code> au lieu d‚Äô<code class=\"language-text\">apt-get</code> dans nos <strong>scripts</strong>:<br>\n<code class=\"language-text\">WARNING : apt does not have a stable CLI interface. Use with caution in scripts</code></p>\n<h1>Fichiers sources.list</h1>\n<p><code class=\"language-text\">apt</code> se base sur des fichiers <a href=\"https://wiki.debian.org/fr/SourcesList\"><code class=\"language-text\">sources.list</code></a> pour savoir o√π se trouvent les d√©p√¥ts (repositories) de paquets sur internet concernant la version de notre distribution Linux et il est possible d‚Äôajouter d‚Äôautres listes dans <code class=\"language-text\">/etc/apt/sources.list.d/</code>.</p>\n<p>Pour aller plus loin √† propos des fichiers <code class=\"language-text\">sources.list</code> lire ce tr√®s <a href=\"https://debian-facile.org/doc:systeme:apt:sources.list\">bon article de debian-facile</a>.</p>\n<h2>Mise √† jours de l'OS</h2>\n<p>La version de l'OS peut etre mise √† jour en quelques √©tapes simples :</p>\n<h3>MAJ des packages du syst√®me actuel</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> update <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> upgrade -y</code></pre></div>\n<h3>Edition du sources.list</h3>\n<ul>\n<li>pour passer de <strong>Debian 9</strong> √† <strong>Debian 10</strong>, remplacer toutes les occurence de <code class=\"language-text\">stretch</code> par <code class=\"language-text\">buster</code></li>\n<li>pour passer de <strong>Debian 10</strong> √† <strong>Debian 11</strong>, remplacer toutes les occurence de  <code class=\"language-text\">buster/updates</code> par <code class=\"language-text\">bullseye-security</code> et <code class=\"language-text\">buster</code>  par <code class=\"language-text\">bullseye</code>.</li>\n</ul>\n<h3>MAJ des packages du syst√®me nouvelle version</h3>\n<p>Et enfin remettre √† jour le syst√®me avec ces nouvelles r√©f√©rences :</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> update <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> -y full-upgrade</code></pre></div>\n<p>Et voil√† nous disposons d'une distribution Linux plus r√©cente üéâ</p>\n<h1>Commandes apt</h1>\n<p>Les commandes suivantes n√©cessitent des privil√®ges √©lev√©s <code class=\"language-text\">sudo</code></p>\n<h2>Listing et infos</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">apt</span> list --installed        <span class=\"token comment\"># liste les packages install√©s</span>\n<span class=\"token function\">apt</span> search nom-package\n<span class=\"token function\">apt</span> show nom-package\n\ndpkg -L nom-package         <span class=\"token comment\"># peut apporter plus d'infos qu'apt show</span></code></pre></div>\n<h2>Installer/desinstaller</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">apt</span> <span class=\"token function\">install</span> nom-package1 nom-package2\n<span class=\"token function\">apt</span> <span class=\"token function\">install</span> -t jessie-backports nom-package   <span class=\"token comment\"># install d'une ancienne version (backport)</span>\n<span class=\"token function\">apt</span> <span class=\"token function\">install</span> /xxx/T√©l√©chargements/nom-package.deb\n\n<span class=\"token function\">apt</span> remove nom-package <span class=\"token comment\"># supprime juste les binaires</span>\n<span class=\"token function\">apt</span> purge nom-package <span class=\"token comment\"># supprime les binaires ET fichiers conf</span></code></pre></div>\n<h2>Gestion des d√©p√¥ts et maintenance</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\">## gestion des d√©p√¥ts</span>\n<span class=\"token function\">apt</span> update              <span class=\"token comment\"># cherche les MAJ</span>\n<span class=\"token function\">apt</span> list --upgradable   <span class=\"token comment\"># liste ce qu'un upgrade mettrait √† jour</span>\n<span class=\"token function\">apt</span> upgrade             <span class=\"token comment\"># installe les MAJ dispo</span>\n<span class=\"token function\">apt</span> full-upgrade        <span class=\"token comment\"># upgrade avec gestion des conflicts</span>\n<span class=\"token function\">apt</span> dist-upgrade        <span class=\"token comment\"># deprecated, privil√©gier apt full-upgrade</span>\n\n<span class=\"token function\">apt</span> edit-sources\n<span class=\"token function\">apt</span> edit-sources depot-specifique.list <span class=\"token comment\"># situ√© dans /etc/apt/sources.list.d/</span></code></pre></div>\n<p>un bon post sur les <a href=\"https://www.lecoindunet.com/difference-apt-update-upgrade-full-upgrade\">diff√©rences entre apt update, upgrade, dist-upgrade et full-upgrade</a></p>\n<h2>Maintenance</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">apt</span> clean <span class=\"token comment\"># supprime les packages et les scripts d'install de /var/cache/apt/archives/</span>\n<span class=\"token function\">apt</span> autoremove  <span class=\"token comment\"># supprime les d√©pendances inutiles</span>\n<span class=\"token function\">apt</span> --purge autoremove <span class=\"token comment\"># idem avec les fichiers de conf</span></code></pre></div>\n<h1>Astuce</h1>\n<p>Pour d√©terminer la date d‚Äôinstallation d‚Äôun package via APT il faut <a href=\"https://askubuntu.com/questions/73180/how-to-see-packages-installed-on-a-given-date-using-aptitude\">passer par la date</a> des fichiers situ√©s sous <code class=\"language-text\">/var/lib/dpkg/info/</code>.</p>\n<h1>Liens</h1>\n<p><a href=\"https://askubuntu.com/questions/187888/what-is-the-correct-way-to-completely-remove-an-application\">What is the correct way to completely remove an application?</a> (Stack Exchange <a href=\"askubuntu.com\">Asku Ubuntu</a>)</p>"}},
    "staticQueryHashes": ["1026020893","28434099","3153813225"]}