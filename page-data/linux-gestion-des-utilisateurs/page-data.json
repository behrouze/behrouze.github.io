{
    "componentChunkName": "component---src-templates-wp-post-tsx",
    "path": "/linux-gestion-des-utilisateurs",
    "result": {"pageContext":{"id":"ceeec5c5-a733-50ec-aa57-99e5057f6941","fileAbsolutePath":"/home/behrouze/Sources/gatsby-blog/obsidian/Blog/linux-gestion-des-utilisateurs.md","frontmatter":{"categories":["linux"],"date":"2018-08-27","lastUpdate":null,"tags":["admin-linux","linux"],"title":"Linux: gestion des utilisateurs"},"html":"<h2>Gestion des utilisateurs</h2>\n<h3>Ajout</h3>\n<p>sudo useradd -m toto  création d'un nouvel utilisateur toto, avec création d'un home dir (option -m) sudo adduser  est une commande (script perl qui utilise useradd) qui fourni une interface en ligne de commande avec une série de questions ce qui est plus agréable lorsque l'on cré l'utilisateur interactivement.</p>\n<h3>Création ou modification du mot de passe d'un user</h3>\n<p>sudo passwd toto  permet de modifier interactivement le passwd de toto</p>\n<h3>Gestion des groupes d'utilisateurs</h3>\n<p>sudo addgroup joueurs  <strong>ajoute</strong> un <strong>nouveau groupe</strong> au <strong>système</strong></p>\n<p>sudo delgroup joueurs  <strong>supprime</strong> le <strong>groupe</strong> spécifié du <strong>système</strong></p>\n<p>sudo usermod -a -G joueurs $USER  <strong>ajoute</strong> l'utilisateur courant <strong>au groupe</strong> spécifié</p>\n<h3>Suppression ou désactivation</h3>\n<p>sudo deluser -r -f toto  : supprime l'utilisateur du système.</p>\n<ul>\n<li><strong>-r</strong> supprime le répertoire home de ce user</li>\n<li><strong>-f</strong> force la suppression des fichiers du home, même ceux qui n'appartiennent pas à ce user</li>\n</ul>\n<p>sudo passwd -l toto  : désactive le login sur le système avec login/mot de passe, attention le login via clé SSH sera toujours fonctionnel avec cette commande. Intervient sur le fichier /etc/shadow</p>\n<p>sudo usermod --expiredate 1 toto  : désactive complètement le compte sans le supprimer du système, bloque également l'accès via clés SSH. Intervient sur le fichier /etc/passwd usermod permet de changer les caractéristiques d'un compte (expiration, chemin du dossier home, groupes etc)</p>\n<h2>Sudo</h2>\n<p>La commande <a href=\"https://wiki.debian.org/fr/sudo\"><strong>sudo</strong></a> permet à un utilisateur autorisé, d'<strong>exécuter des commandes avec les droits d'admins</strong>. Cette commande (à installer avec apt) s'appuie sur le fichier de conf <strong>/etc/sudoers</strong>.</p>\n<p>Il est <strong>vivement recommandé d'utiliser</strong> l'utilitaire <strong>visudo</strong> pour modifier ce fichier, car il effectuera une vérification syntaxique avant la sauvegarde du fichier /etc/sudoers. Il est possible de configurer un éditeur de texte en particulier (ici Vim) en lançant visudo :</p>\n<p>sudo VISUAL=<code class=\"language-text\">command -v vi</code> visudo</p>\n<p>La <strong>syntaxe générale</strong> est la suivante :</p>\n<p>login_du_user ALL =(user) commande1, NOPASSWD: commande2,...</p>\n<p>Pour <strong>autoriser un utilisateur</strong> toto à lancer n'importe quelle commandes :</p>\n<p>toto ALL=(ALL) ALL</p>\n<p>et pour autoriser l'exécution de sudo <strong>sans demander de mot de passe</strong> grâce à l'argument <strong>NOPASSWD</strong> (attention danger!):</p>\n<p>toto ALL=(ALL) NOPASSWD:ALL</p>\n<p>Il est également possible d'attribuer les droits à un <strong>groupe d'utilisateurs</strong>, il suffira alors de rajouter notre utilisateur à ce groupe (ex ici un groupe nommé sudo):</p>\n<p>%sudo ALL=(ALL) NOPASSWD:ALL</p>\n<p>Voici la signification de chaque argument (<a href=\"https://serversforhackers.com/c/sudo-and-sudoers-configuration\">tiré de serversforhackers)</a> et l'étendu de leur application :</p>\n<ul>\n<li><strong>toto</strong> ALL=(ALL:ALL) ALL -> utilisateur toto</li>\n<li>toto <strong>ALL</strong>=(ALL:ALL) ALL -> <strong>tous</strong> les utilisateurs totos, loggés depuis <strong>n'importe quel machine</strong></li>\n<li>toto ALL=(<strong>ALL</strong>:ALL) ALL -> utilisateur toto peut exécuter les commandes en tant que <strong>n'importe quel utilisateur</strong></li>\n<li>toto ALL=(ALL:<strong>ALL</strong>) ALL -> utilisateur toto peut exécuter les commandes en tant que <strong>n'importe quel groupe</strong></li>\n<li>toto ALL=(ALL:ALL) <strong>ALL</strong> -> cette règle s'applique à toutes les commandes (c'est ici qu'on spécifie la liste de commandes, si on ne souhaite pas donner accès à toutes les commandes du système)</li>\n<li>toto ALL=(ALL:ALL) **NOPASSWD:**ALL -> aucun password requis pas toto, il peut tout exécuter sur la machine sans limite</li>\n</ul>\n<h2>Fichiers importants</h2>\n<p>/etc/passwd</p>\n<p>/etc/shadow</p>\n<p>/etc/login.defs</p>\n<p>/etc/deluser.conf</p>\n<p>/etc/skel : arborescence par défaut copié lors d'un useradd -m</p>\n<p>/etc/sudoers</p>"}},
    "staticQueryHashes": ["1026020893","1333896537","28434099"]}