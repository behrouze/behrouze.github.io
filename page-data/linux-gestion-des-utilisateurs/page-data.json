{
    "componentChunkName": "component---src-templates-wp-post-tsx",
    "path": "/linux-gestion-des-utilisateurs",
    "result": {"pageContext":{"id":"ceeec5c5-a733-50ec-aa57-99e5057f6941","fileAbsolutePath":"/home/behrouze/Sources/gatsby-blog/obsidian/Blog/linux-gestion-des-utilisateurs.md","frontmatter":{"categories":["linux"],"date":"2018-08-27","lastUpdate":null,"tags":["admin-linux","linux"],"title":"Linux: gestion des utilisateurs"},"html":"<h2>Gestion des utilisateurs</h2>\n<h3>Ajout</h3>\n<p><code class=\"language-text\">sudo useradd -m toto</code>  création d'un nouvel utilisateur toto, avec création d'un home dir (option <code class=\"language-text\">-m</code>) <code class=\"language-text\">sudo adduser</code>  est une commande (script perl qui utilise useradd) qui fourni une interface en ligne de commande avec une série de questions ce qui est plus agréable lorsque l'on cré l'utilisateur interactivement.</p>\n<h3>Création ou modification du mot de passe d'un user</h3>\n<p><code class=\"language-text\">sudo passwd toto</code>  permet de modifier interactivement le passwd de toto</p>\n<h3>Gestion des groupes d'utilisateurs</h3>\n<h4>Ajout/création</h4>\n<p><code class=\"language-text\">sudo addgroup joueurs</code>  <strong>ajoute</strong> un <strong>nouveau groupe</strong> au <strong>système</strong></p>\n<h4>Suppression</h4>\n<p><code class=\"language-text\">sudo delgroup joueurs</code>  <strong>supprime</strong> le <strong>groupe</strong> spécifié du <strong>système</strong></p>\n<h4>Ajout à un groupe</h4>\n<p><code class=\"language-text\">sudo usermod -a -G joueurs $USER</code>  <strong>ajoute</strong> l'utilisateur courant <strong>au groupe</strong> spécifié</p>\n<h4>Suppression</h4>\n<p><code class=\"language-text\">sudo deluser -r -f toto</code>  : supprime l'utilisateur du système.</p>\n<ul>\n<li><code class=\"language-text\">-r</code> supprime le répertoire home de ce user</li>\n<li><code class=\"language-text\">-f</code> force la suppression des fichiers du home, même ceux qui n'appartiennent pas à ce user</li>\n</ul>\n<h4>Désactivation</h4>\n<p><code class=\"language-text\">sudo passwd -l toto</code>  : désactive le login sur le système avec login/mot de passe, attention le login via clé SSH sera toujours fonctionnel avec cette commande. Intervient sur le fichier <code class=\"language-text\">/etc/shadow</code> sans supprimer le dossier utilisateur</p>\n<p><code class=\"language-text\">sudo usermod --expiredate 1 toto</code>  : désactive complètement le compte sans le supprimer du système, bloque également l'accès via clés SSH. Intervient sur le fichier <code class=\"language-text\">/etc/passwd</code></p>\n<p><code class=\"language-text\">usermod</code> permet de changer les caractéristiques d'un compte (expiration, chemin du dossier home, groupes etc)</p>\n<h2>Sudo</h2>\n<p>La commande <a href=\"https://wiki.debian.org/fr/sudo\"><strong>sudo</strong></a> permet à un utilisateur autorisé, d'<strong>exécuter des commandes avec les droits d'admins</strong>. Cette commande (à installer avec apt) s'appuie sur le fichier de conf <strong>/etc/sudoers</strong>.</p>\n<p>Il est <strong>vivement recommandé d'utiliser</strong> l'utilitaire <strong>visudo</strong> pour modifier ce fichier, car il effectuera une vérification syntaxique avant la sauvegarde du fichier /etc/sudoers. Il est possible de configurer un éditeur de texte en particulier (ici Vim) en lançant visudo :</p>\n<p><code class=\"language-text\">sudo VISUAL=\\</code>command -v vi` visudo`</p>\n<p>La <strong>syntaxe générale</strong> est la suivante :</p>\n<p><code class=\"language-text\">login_du_user ALL =(user) commande1, NOPASSWD: commande2,...</code></p>\n<p>Pour <strong>autoriser un utilisateur</strong> toto à lancer n'importe quelle commandes :</p>\n<p><code class=\"language-text\">toto ALL=(ALL) ALL</code></p>\n<p>et pour autoriser l'exécution de sudo <strong>sans demander de mot de passe</strong> grâce à l'argument <strong>NOPASSWD</strong> (attention danger!):</p>\n<p><code class=\"language-text\">toto ALL=(ALL) NOPASSWD:ALL</code></p>\n<p>Il est également possible d'attribuer les droits à un <strong>groupe d'utilisateurs</strong>, il suffira alors de rajouter notre utilisateur à ce groupe (ex ici un groupe nommé sudo):</p>\n<p><code class=\"language-text\">%sudo ALL=(ALL) NOPASSWD:ALL</code></p>\n<p>Voici la signification de chaque argument (<a href=\"https://serversforhackers.com/c/sudo-and-sudoers-configuration\">tiré de serversforhackers)</a> et l'étendu de leur application :</p>\n<ul>\n<li><strong>toto</strong> ALL=(ALL:ALL) ALL -> utilisateur toto</li>\n<li>toto <strong>ALL</strong>=(ALL:ALL) ALL -> <strong>tous</strong> les utilisateurs totos, loggés depuis <strong>n'importe quel machine</strong></li>\n<li>toto ALL=(<strong>ALL</strong>:ALL) ALL -> utilisateur toto peut exécuter les commandes en tant que <strong>n'importe quel utilisateur</strong></li>\n<li>toto ALL=(ALL:<strong>ALL</strong>) ALL -> utilisateur toto peut exécuter les commandes en tant que <strong>n'importe quel groupe</strong></li>\n<li>toto ALL=(ALL:ALL) <strong>ALL</strong> -> cette règle s'applique à toutes les commandes (c'est ici qu'on spécifie la liste de commandes, si on ne souhaite pas donner accès à toutes les commandes du système)</li>\n<li>toto ALL=(ALL:ALL) **NOPASSWD:**ALL -> aucun password requis pas toto, il peut tout exécuter sur la machine sans limite</li>\n</ul>\n<h2>Fichiers importants</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">/etc/passwd\n/etc/shadow\n/etc/login.defs\n/etc/deluser.conf\n/etc/skel <span class=\"token comment\"># arborescence par défaut copié lors d'un useradd -m</span>\n/etc/sudoers</code></pre></div>"}},
    "staticQueryHashes": ["1026020893","28434099","3153813225"]}