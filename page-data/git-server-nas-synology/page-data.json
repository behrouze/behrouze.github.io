{
    "componentChunkName": "component---src-templates-wp-post-tsx",
    "path": "/git-server-nas-synology",
    "result": {"pageContext":{"id":"c280605b-1e5b-5927-a704-9664c4414c18","fileAbsolutePath":"/Users/behrouze/Sources/gatsby-blog/obsidian/Blog/git-server-nas-synology.md","frontmatter":{"categories":["linux"],"date":"2018-05-10","lastUpdate":"2022-01-24","tags":["dsm","fullstack","git","linux","synology","tutoriel","vscode"],"title":"Serveur Git sur un NAS Synology"},"html":"<p>Git est un outil de <strong>SCM</strong> (Source Code Management), il permet simplement de <strong>sauvegarder</strong> des fichiers et leurs différentes <strong>versions</strong> au cours du temps, mais également de faciliter le travail <strong>collaboratif</strong> des développeurs.</p>\n<h2>Installation d'un serveur Git sur un NAS Synology</h2>\n<h3>Préparation de l'intallation</h3>\n<ol>\n<li>créer un <strong>nouvel utilisateur git sur le DSM</strong>, ce qui permettera les push coté clients via SSH</li>\n<li><strong>ajouter</strong> les <strong>clés SSH</strong> publiques des clients (ceux qui vont se connecter aux répos) dans <code class=\"language-text\">~/.ssh/authorized_keys</code> de ce nouvel utilisateur, pour permettre l'authentification lors des commandes <code class=\"language-text\">git</code></li>\n<li><strong>créer un dossier</strong> où seront stockés les repos par ex: <code class=\"language-text\">/volume1/git_repos</code></li>\n<li>puis appliquer les permissions adequats:</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">chown</span> git:git-users /volume1/git_repos <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">chmod</span> g+s /volume1/git_repos</code></pre></div>\n<h3>Installation de l'application Synology</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 850px; box-shadow: 3px 5px 4px rgba(0,0,0,.1);margin:1rem;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/db770b5d27f5869383a67627df0082b2/ee515/2018-10-09-12_46_04-backup-Synology-DiskStation.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.84976525821596%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7CAAAOwgEVKEqAAAAClklEQVQ4y22Ty28cRRDG5z/kH+ASJV7lkBhLcOGCD7kEgUTsvA8QgnKIgxC5cIkUcUiAJKAE4ScCbNbrzazX+5jpd0/3zA9Nz0JklJbqUNXVX331VXX2zoePOL/+C2fWdjlzZYtzV3foXd+ld32P3o3f6a39xtLlnzj78TPOf/qc3s0deje3Wbq1zdLt1rY4e2uTc7c3effqr2SXvnwCVEAD1NBEqqrCG4PTmqAkuhQIofBKtRnUNJ01DS5ESu3wIfBHXpItrz1n4+ecO8/GfPXjiH5e0liDFBqjLW89TfM/t/MHU0N2Yf0Fl747YOWbAy5u7LM9CVTGJpYtgxAidd0QlCIGT4itX+OcI89HxLpOOf8Brn7996Ll2Jm32EGOLOYIqbDWUseaOBwhZdu6TIBHR0fcvfMFZSlQ2nSAM0v2wf1+cqoaQgPBOvx8itQGoXS6c84zyEfMCok2LsVCrJkojzIOX3UMD1vAlY1hcmLd6dBW39v6nsmwj7E+xYb5iM/WP+HPvw4oyjIN8EQ6Hr4aYI1J4Inh3JGtPHi9AHoDOLYeUQiskB2bEHHaoK3H+pBi0kf6pUMog3Fd4X7L8L0H+SmGbbWHm2NGM0GlFVQeHxusdIh5QVGUKW9z6nn/6TGzosSYbhv2x4ps+f7oFGAVAoN+n6IUGF+B94RiTpgcU06mmFLQWEsMFd4rlLH40LW8f6LJlu8tABc6lEXB6ker7O7upZWoQ6A6GVM9eYSUEh9j+gNhNqAqd9KQ/iVzOHNkF+/mbzRsuu2vhEAp3enV7qCRRHGMlAajDLVWaGMYmkDRfoCFhodTR3bh89enpxwj5sUP6Ok0gbfnWAlePv4WOxzg0+OaA1lz7bFhPpVU1WIoE8c/l0LGQqC4pz4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/db770b5d27f5869383a67627df0082b2/bc663/2018-10-09-12_46_04-backup-Synology-DiskStation.webp 213w,\n/static/db770b5d27f5869383a67627df0082b2/8dc4f/2018-10-09-12_46_04-backup-Synology-DiskStation.webp 425w,\n/static/db770b5d27f5869383a67627df0082b2/10237/2018-10-09-12_46_04-backup-Synology-DiskStation.webp 850w,\n/static/db770b5d27f5869383a67627df0082b2/a5e36/2018-10-09-12_46_04-backup-Synology-DiskStation.webp 1269w\"\n              sizes=\"(max-width: 850px) 100vw, 850px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/db770b5d27f5869383a67627df0082b2/3cb16/2018-10-09-12_46_04-backup-Synology-DiskStation.png 213w,\n/static/db770b5d27f5869383a67627df0082b2/2fbbf/2018-10-09-12_46_04-backup-Synology-DiskStation.png 425w,\n/static/db770b5d27f5869383a67627df0082b2/ae694/2018-10-09-12_46_04-backup-Synology-DiskStation.png 850w,\n/static/db770b5d27f5869383a67627df0082b2/ee515/2018-10-09-12_46_04-backup-Synology-DiskStation.png 1269w\"\n            sizes=\"(max-width: 850px) 100vw, 850px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/db770b5d27f5869383a67627df0082b2/ae694/2018-10-09-12_46_04-backup-Synology-DiskStation.png\"\n            alt=\"2018 10 09 12 46 04 backup Synology DiskStation\"\n            title=\"2018 10 09 12 46 04 backup Synology DiskStation\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\nDepuis le package center du DSM, installation de l'application git.\nAu niveau des permissions, les users du groupe Admin auront accès d'office.\nRebooter le NAS pour terminer la procédure d'installation.</p>\n<h2>Initialisation du repo Git</h2>\n<p>Pour pouvoir utiliser git il faut initialiser les 2 cotés client et serveur.</p>\n<h3>Initialisation git coté Serveur</h3>\n<p>Création d'un dépot Git\nSe logger sur le NAS en ssh puis initialiser un repo git comme ceci :</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">sudo</span> <span class=\"token function\">git</span> init --bare --shared /volume1/git_repos/newgitrepo.git\n<span class=\"token function\">sudo</span> <span class=\"token function\">chown</span> -R root:git-users /volume1/git_repos/newgitrepo.git</code></pre></div>\n<h3>Initialisation git coté client</h3>\n<p>Pour pouvoir effectuer un <code class=\"language-text\">git push</code> avec un client git, il faut bien entendu avoir initialisé un repo git local avec un <code class=\"language-text\">git init</code> puis ajouter le repo remote :</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">git</span> remote <span class=\"token function\">add</span> dsm ssh://mon_username@mon_servername/volume1/git_repos/newgitrepo.git\n<span class=\"token function\">git</span> remote -v</code></pre></div>\n<p><code class=\"language-text\">git push</code> ne fonctionnera pas simplement la 1ère fois sans spécifier l'<strong>option</strong> <code class=\"language-text\">--set-upstream</code>, car le système ignore qu'on souhaite pousser sur la branche master.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">git</span> push --set-upstream mon_servername master</code></pre></div>\n<h2>Liens</h2>\n<ul>\n<li>documentation <a href=\"https://kb.synology.com/fr-fr/DSM/help/Git/git\">Synology de l'installation de git</a></li>\n<li><a href=\"https://git-scm.com/book/fr/v1/Les-bases-de-Git-D%C3%A9marrer-un-d%C3%A9p%C3%B4t-Git\">doc officielle git-scm en français</a></li>\n<li>la magnifique <a href=\"https://www.atlassian.com/fr/git\">documentation git d'Atlassian</a></li>\n<li>introduction sur <a href=\"https://grafikart.fr/tutoriels/git\">graphikart</a></li>\n<li>liste d'<a href=\"https://techoverflow.net/2017/08/09/how-to-solve-git-fatal-no-configured-push-destination/\">erreurs fréquement rencontrées</a></li>\n</ul>"}},
    "staticQueryHashes": ["1026020893","28434099","3153813225"]}