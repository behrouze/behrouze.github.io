{
    "componentChunkName": "component---src-templates-wp-post-tsx",
    "path": "/certificats-ssl-tls-gratuits-letsencrypt",
    "result": {"pageContext":{"id":"4d7ae37d-496d-5689-ad4f-f4c032af8fe9","fileAbsolutePath":"/Users/behrouze/Sources/gatsby-blog/obsidian/Blog/certificats-ssl-tls-gratuits-letsencrypt.md","frontmatter":{"categories":["linux"],"date":"2018-08-30","lastUpdate":null,"tags":["admin-linux","linux","certbot","ssl"],"title":"Let's Encrypt: les certificats SSL/TLS gratuits"},"html":"<p><a href=\"https://letsencrypt.org/\">Let's Encrypt</a> est une <strong>autorité de certification</strong> ?(CA en anglais) gérée par l’<a href=\"https://letsencrypt.org/isrg/\">ISRG</a> qui est <a href=\"https://letsencrypt.org/sponsors\">sponsorisé</a> par quelques mastodontes du web tel que Mozilla, Akamai, Cisco, <a href=\"https://www.eff.org/\">EFF</a>.</p>\n<p>Let's Encrypt présente la particularité de fournir <strong>gratuitement ?</strong> un <strong>système automatisé de délivrance de certificats SSL</strong> (pour info SSL = TLS), et pour cela l'ISRG a développé le <a href=\"https://fr.wikipedia.org/wiki/ACME_(protocole)\">protocole ACME</a>  qui est exploité par le CLI <a href=\"https://certbot.eff.org/about/\">Certbot</a> (développé par l'EFF) qui va nous permettre de récupérer et installer les certificats SSL facilement!</p>\n<h1>Installer Certbot</h1>\n<p>Le script <a href=\"https://certbot.eff.org/\">certbot</a> (ou certbot-auto ou letsencrypt ?) est donc l'outil que nous allons utiliser pour <strong>gérer</strong> (obtenir, renouveller ou révoquer) <strong>les certificats SSL Let's Encrypt sur notre serveur Web</strong> (certbot n'est dispo que sur les Unix/Linux actuellement).</p>\n<p>Pour l'installer suivre la <strong><a href=\"https://certbot.eff.org/lets-encrypt/debianstretch-nginx\">procédure</a> propre à chaque système</strong>, identifier notre système et versions par :</p>\n<p>grep -wE 'ID_LIKE|VERSION' /etc/*-release</p>\n<p>dans mon cas, mon serveur web est hébergé sur un Raspberry Pi et le système Raspbian est un dérivé de Debian Stretch, et voici donc la <a href=\"https://certbot.eff.org/lets-encrypt/debianstretch-nginx\">procédure</a> mon mon système (Stretch):</p>\n<p># il faut d'abord ajouter le répo backports pour debian Stretch\nsudo sh -c \"echo \"deb <a href=\"http://ftp.debian.org/debian\">http://ftp.debian.org/debian</a> stretch-backports main\" > /etc/apt/sources.list.d/stretch-backports.list\"</p>\n<h1>puis installer le CLI certbot</h1>\n<p>sudo apt update &#x26;&#x26; sudo apt install python-certbot-nginx -t stretch-backports</p>\n<p><em>note: on utilise un repo apt spécifique aux <a href=\"https://backports.debian.org/Instructions\">backports</a> debian stretch, faire abstraction des erreurs gpg ou <a href=\"https://raspberrypi.stackexchange.com/questions/12258/where-is-the-archive-key-for-backports-debian-org\">corriger</a></em></p>\n<h1>Principe d'utilisation de Certbot</h1>\n<p><strong>Certbot</strong> permet via la <strong>ligne de commande</strong>, d'effectuer les actions suivantes grâce à un <a href=\"https://certbot.eff.org/docs/using.html#getting-certificates-and-choosing-plugins\"><strong>système de plugins</strong></a> (qu'il est important de bien comprendre) qui sont de 2 types:</p>\n<ol>\n<li>les plugins <strong>authenticators</strong></li>\n<li>les plugins <strong>installers</strong></li>\n</ol>\n<h2><strong>Authentifier votre serveur web</strong></h2>\n<p>La <strong>CLI certbot</strong>, va vous permettre d'<strong>authentifier votre serveur web</strong> en tant hébergeur du domaine dont vous souhaitez obtenir le certificat, pour ensuite <strong>récupérer</strong> un certificat SSL valide pour une durée de 3 mois.<br>\nPour cette étape, il faut utiliser les <strong>plugins de type authenticators</strong> que l'on va spécifier via la <em>sous-commande</em> *<strong>*certonly**</strong>.<br>\nVoici un exemple d'utilisation du plugin authenticator <a href=\"https://certbot.eff.org/docs/using.html#webroot\">webroot</a> avec l'option --webroot-path (-w):</p>\n<p>sudo certbot certonly --webroot -w /var/www/example -d <a href=\"http://www.example.com\">www.example.com</a> -d example.com</p>\n<h2>Installer le certificat</h2>\n<p>La CLI peut <em>éventuellement</em> permettre d'installer ce certificat sur votre serveur web (Nginx, Apache etc.), pour cela il faut utiliser les <strong>plugins de type installers</strong> via la <em>sous-commande</em> <strong>install</strong></p>\n<p><em>Certains plugins</em> sont des <strong>authenticators</strong> et des <strong>installers</strong> comme les <a href=\"https://certbot.eff.org/docs/using.html#getting-certificates-and-choosing-plugins\">plugins apache et ngnix</a> (voir également les <a href=\"https://certbot.eff.org/docs/using.html#third-party-plugins\">plugins non officiels</a>), ils sont alors utilisable via la sous-commande <strong>run</strong> (qui est implicitement utilisée lorsqu'on ne spécifie ni certonly, ni install).<br>\nIl faudra alors utiliser des options pour spécifier les plugins --authenticator  (ou -a) et --installer (ou -i).</p>\n<p>sudo certbot run -a webroot -i nginx -w /var/www/html -d example.com</p>\n<p>Si on souhaite <strong>obtenir un certificat à la main</strong>, il est possible  d'utiliser le <a href=\"https://certbot.eff.org/docs/using.html#manual\">plugin authenticator manual</a>.</p>\n<h1>Gestion des certificats</h1>\n<h3>Lister les certificats</h3>\n<p>Certbot propose de nombreuses possibilité en matière de <a href=\"https://certbot.eff.org/docs/using.html#managing-certificates\">gestion de certificats</a>.</p>\n<p>La commande sudo certbot certificates  permet d'afficher les informations concernant les certificats SSL actuellement installés sur votre serveur.</p>\n<p>A noter que cette sous-commande nous indique les informations concernant nos domaines ainsi que les <strong>fichiers</strong> de clés privés et certificats, par contre <strong>elle n'indique pas</strong> si notre <strong>serveur web est correctement configuré</strong> pour les exploiter.</p>\n<h3>Révoquer un certificat</h3>\n<p>En cas d'attaque du serveur web contenant les certificats, il est important de <a href=\"https://certbot.eff.org/docs/using.html#revoking-certificates\">révoquer</a> et supprimer les certificats installés (car exploitable par les hackers), puis en régénérer de nouveaux:</p>\n<p>sudo certbot revoke --cert-path /etc/letsencrypt/live/CERTNAME/cert.pem --reason keycompromise</p>\n<p>l'option <em>--reason</em> est optionnelle et peut comprendre les valeurs :<br>\nunspecified (par défaut) keycompromise affiliationchanged superseded ou cessationofoperation</p>\n<p>sudo certbot delete --cert-name example.com</p>\n<h1>Aller plus loin</h1>\n<p>Pour bien comprendre comment fonctionne Certbot (obtention et installation de certificats) et son système de plugins lire le <a href=\"https://certbot.eff.org/docs/using.html\">User Guide</a>, un peu long ? mais très intéressant ?</p>\n<p>Le site de <a href=\"https://letsencrypt.org/docs/\">Let's Encrypt</a> comporte également beaucoup d'informations.</p>"}},
    "staticQueryHashes": ["1026020893","1333896537","28434099"]}