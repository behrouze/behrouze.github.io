<!DOCTYPE html><html lang="fr"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta data-react-helmet="true" name="msvalidate.01" content="A50293F74A3B85CC8957428EEEEAABA5"/><meta data-react-helmet="true" name="google-site-verification" content="kkqrNKWAArklwdQl9I2c0KZhhbL8Q8p4fVsYQkC4d_A"/><meta data-react-helmet="true" name="description" content="Blog technique et mÃ©mo sur les technos .Net et Javascript React ainsi que l&#x27;outillage devops"/><meta data-react-helmet="true" charSet="utf-8"/><meta name="generator" content="Gatsby 4.5.3"/><style data-href="/styles.3c3647db791b55739a08.css" data-identity="gatsby-global-css">code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#000;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-o-tab-size:4;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{margin:.5em 0;overflow:visible;padding:1px;position:relative}pre[class*=language-]>code{background-attachment:local;background-color:#fdfdfd;background-image:linear-gradient(transparent 50%,rgba(69,142,209,.04) 0);background-origin:content-box;background-size:3em 3em;border-left:10px solid #358ccb;box-shadow:-1px 0 0 0 #358ccb,0 0 0 1px #dfdfdf;position:relative;z-index:1}code[class*=language-]{display:block;height:inherit;max-height:inherit;overflow:auto;padding:0 1em}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdfdfd;box-sizing:border-box;margin-bottom:1em}:not(pre)>code[class*=language-]{border:1px solid rgba(0,0,0,.1);border-radius:.3em;color:#c92c2c;display:inline;padding:.2em;position:relative;white-space:normal}pre[class*=language-]:after,pre[class*=language-]:before{bottom:.75em;box-shadow:0 13px 8px #979797;content:"";display:block;height:20%;left:.18em;max-height:13em;position:absolute;-webkit-transform:rotate(-2deg);transform:rotate(-2deg);width:40%}pre[class*=language-]:after{left:auto;right:.75em;-webkit-transform:rotate(2deg);transform:rotate(2deg)}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#7d8b99}.token.punctuation{color:#5f6364}.token.boolean,.token.constant,.token.deleted,.token.function-name,.token.number,.token.property,.token.symbol,.token.tag{color:#c92c2c}.token.attr-name,.token.builtin,.token.char,.token.function,.token.inserted,.token.selector,.token.string{color:#2f9c0a}.token.entity,.token.operator,.token.url,.token.variable{background:hsla(0,0%,100%,.5);color:#a67f59}.token.atrule,.token.attr-value,.token.class-name,.token.keyword{color:#1990b8}.token.important,.token.regex{color:#e90}.language-css .token.string,.style .token.string{background:hsla(0,0%,100%,.5);color:#a67f59}.token.important{font-weight:400}.token.bold{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.namespace{opacity:.7}@media screen and (max-width:767px){pre[class*=language-]:after,pre[class*=language-]:before{bottom:14px;box-shadow:none}}pre[class*=language-].line-numbers.line-numbers{padding-left:0}pre[class*=language-].line-numbers.line-numbers code{padding-left:3.8em}pre[class*=language-].line-numbers.line-numbers .line-numbers-rows{left:0}pre[class*=language-][data-line]{padding-bottom:0;padding-left:0;padding-top:0}pre[data-line] code{padding-left:4em;position:relative}pre .line-highlight{margin-top:0}.heading{color:#639}ul.nav-links{display:flex;justify-content:space-between;list-style:none;padding-left:0}a{text-decoration:none}h1{-webkit-text-fill-color:transparent;background:linear-gradient(90deg,#30cfd0 0,#330867);-webkit-background-clip:text;text-transform:uppercase;transition:font-size .3s}h1,h1.posts{font-family:sans-serif;font-size:2rem;margin-bottom:0}h1.posts{-webkit-text-fill-color:transparent;background:linear-gradient(90deg,#164972 0,#041955);-webkit-background-clip:text;text-transform:none}h1.small{font-size:1.5rem}pre{background-color:#f5f6f8;overflow-x:scroll;padding:.3rem}blockquote{background-color:#f0f8ff;border-radius:5px;padding:.3rem 1rem}blockquote,img{box-shadow:0 4px 12px rgba(0,0,0,.1)}</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><title data-react-helmet="true">Nagios Core 4.x</title><link data-react-helmet="true" rel="canonical" href="https://blog.behrouze.com"/><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/><link rel="icon" href="/favicon-32x32.png?v=0ae59160d37d7dfca9356a20890d5111" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=0ae59160d37d7dfca9356a20890d5111"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=0ae59160d37d7dfca9356a20890d5111"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=0ae59160d37d7dfca9356a20890d5111"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=0ae59160d37d7dfca9356a20890d5111"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=0ae59160d37d7dfca9356a20890d5111"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=0ae59160d37d7dfca9356a20890d5111"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=0ae59160d37d7dfca9356a20890d5111"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=0ae59160d37d7dfca9356a20890d5111"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><script data-gatsby="web-vitals-polyfill">
            !function(){var e,t,n,i,r={passive:!0,capture:!0},a=new Date,o=function(){i=[],t=-1,e=null,f(addEventListener)},c=function(i,r){e||(e=r,t=i,n=new Date,f(removeEventListener),u())},u=function(){if(t>=0&&t<n-a){var r={entryType:"first-input",name:e.type,target:e.target,cancelable:e.cancelable,startTime:e.timeStamp,processingStart:e.timeStamp+t};i.forEach((function(e){e(r)})),i=[]}},s=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var n=function(){c(e,t),a()},i=function(){a()},a=function(){removeEventListener("pointerup",n,r),removeEventListener("pointercancel",i,r)};addEventListener("pointerup",n,r),addEventListener("pointercancel",i,r)}(t,e):c(t,e)}},f=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(t){return e(t,s,r)}))},p="hidden"===document.visibilityState?0:1/0;addEventListener("visibilitychange",(function e(t){"hidden"===document.visibilityState&&(p=t.timeStamp,removeEventListener("visibilitychange",e,!0))}),!0);o(),self.webVitals={firstInputPolyfill:function(e){i.push(e),u()},resetFirstInputPolyfill:o,get firstHiddenTime(){return p}}}();
          </script><link as="script" rel="preload" href="/webpack-runtime-6c76308e3febb07c5cb7.js"/><link as="script" rel="preload" href="/framework-1b09f98392e3a984ace3.js"/><link as="script" rel="preload" href="/app-2522e8ee87ba4c5fd227.js"/><link as="script" rel="preload" href="/commons-30350ba6450927006b33.js"/><link as="script" rel="preload" href="/bd9a198b5f7fb6fa7f93111e3cc9693331ac2819-9dc0a4f24174f9c3e8bd.js"/><link as="script" rel="preload" href="/component---src-templates-wp-post-tsx-f5cf34345488556083de.js"/><link as="fetch" rel="preload" href="/page-data/nagios4/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1026020893.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1333896537.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/28434099.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css-global o6gwfi">html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;box-sizing:border-box;-webkit-text-size-adjust:100%;}*,*::before,*::after{box-sizing:inherit;}strong,b{font-weight:700;}body{margin:0;color:rgba(0, 0, 0, 0.87);font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;background-color:#fff;}@media print{body{background-color:#fff;}}body::backdrop{background-color:#fff;}</style><style data-emotion="css 1c0cfyw">.css-1c0cfyw{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;display:block;padding-left:16px;padding-right:16px;}@media (min-width:600px){.css-1c0cfyw{padding-left:24px;padding-right:24px;}}@media (min-width:900px){.css-1c0cfyw{max-width:900px;}}</style><div class="MuiContainer-root MuiContainer-maxWidthMd css-1c0cfyw"><a href="/"><h1 class="small">DÃ©veloppeur FullStack &amp; Devops</h1></a><style data-emotion="css mtswq0">.css-mtswq0{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.75;letter-spacing:0.00938em;margin-bottom:0.35em;color:#78909c;}</style><div class="MuiTypography-root MuiTypography-subtitle1 MuiTypography-gutterBottom css-mtswq0">Notes et mÃ©mos techniques</div><main><div class="post-71f0180d-2eee-5ddf-a59a-aff15dcbe8cb"><style data-emotion="css o3d33y">.css-o3d33y{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;color:rgba(0, 0, 0, 0.6);}</style><nav class="MuiTypography-root MuiTypography-body1 MuiBreadcrumbs-root css-o3d33y" aria-label="breadcrumb"><style data-emotion="css nhb8h9">.css-nhb8h9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0;margin:0;list-style:none;}</style><ol class="MuiBreadcrumbs-ol css-nhb8h9"><li class="MuiBreadcrumbs-li"><style data-emotion="css ajwvjb">.css-ajwvjb{-webkit-text-decoration:none;text-decoration:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><style data-emotion="css 15t9hkq">.css-15t9hkq{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.75;letter-spacing:0.00938em;color:#1976d2;-webkit-text-decoration:none;text-decoration:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><a class="MuiTypography-root MuiTypography-subtitle1 MuiLink-root MuiLink-underlineNone css-15t9hkq" href="/"><style data-emotion="css 5xigzu">.css-5xigzu{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:inherit;margin-right:4px;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeInherit css-5xigzu" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="HomeIcon"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"></path></svg></a></li><style data-emotion="css 3mf706">.css-3mf706{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin-left:8px;margin-right:8px;}</style><li aria-hidden="true" class="MuiBreadcrumbs-separator css-3mf706">/</li><li class="MuiBreadcrumbs-li"><style data-emotion="css ytumd6">.css-ytumd6{-webkit-text-decoration:none;text-decoration:none;}</style><style data-emotion="css 1fdfmag">.css-1fdfmag{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.75;letter-spacing:0.00938em;color:#1976d2;-webkit-text-decoration:none;text-decoration:none;}</style><a class="MuiTypography-root MuiTypography-subtitle1 MuiLink-root MuiLink-underlineNone css-1fdfmag" href="/?category=linux">linux</a></li><li aria-hidden="true" class="MuiBreadcrumbs-separator css-3mf706">/</li><li class="MuiBreadcrumbs-li"><style data-emotion="css 1vz2kpn">.css-1vz2kpn{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.75;letter-spacing:0.00938em;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><h6 class="MuiTypography-root MuiTypography-subtitle1 css-1vz2kpn">Nagios Core 4.x</h6></li></ol></nav><h1 class="posts">Nagios Core 4.x</h1><div><p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 300px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/ae56d256fbd17141a2ffe34e37b3c02e/5a46d/Nagios-Logo-300x82.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 27.230046948356808%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABAklEQVQY012QLcuDYBSG/Sv+DZPJYJOZB2qyGhaGzWHzI4nFLDYxrBgs/g8VTM4yDW6i3i/ngY3x3vDAc74u7nM4ADiOA5fLBXVdI0kSjOOIx+NBJbxeLxY/n09UVcVyFJPmecYwDGiaBvu+sxxHMJIgCOB5HqIooixLaJqGIAjgOA4URYHv+7jdbvA8D4ZhsNg0TViWha7rmCl6HMGWZWGDYRhClmVEUYTT6QTbthHHMSRJYoPUc71eoes6XNdlcFVVv47JJQOu64o0TZFlGYqiYGu0bYtt25DnOc7nM+73OxugXqqR+r7/wr4OPx+61TRNeL/f+BXlCfxfn1P9wgj4B1vWTUPgYbsqAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Nagios Logo 300x82"
        title="Nagios Logo 300x82"
        src="/static/ae56d256fbd17141a2ffe34e37b3c02e/5a46d/Nagios-Logo-300x82.png"
        srcset="/static/ae56d256fbd17141a2ffe34e37b3c02e/3cb16/Nagios-Logo-300x82.png 213w,
/static/ae56d256fbd17141a2ffe34e37b3c02e/5a46d/Nagios-Logo-300x82.png 300w"
        sizes="(max-width: 300px) 100vw, 300px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<p>Outil libre de <strong>supervision d'infrastructure</strong>, <a href="https://assets.nagios.com/downloads/nagioscore/docs/nagioscore/4/en/monitoring-linux.html">Nagios</a> est sur le marchÃ© depuis 1996 ?... (alors appelÃ© NetSaint ?). Il permet d'effectuer plusieurs type de supervision sur les serveurs ou Ã©quipements rÃ©seau distants, et les checks basiques peuvent Ãªtre effectuÃ©s dÃ¨s que le serveur installÃ©. Il est ensuite possible d'utiliser des <a href="https://assets.nagios.com/downloads/nagioscore/docs/nagioscore/4/en/addons.html#nrpe">addons</a> pour superviser des Ã©quipements spÃ©cifiques, des middlwares ou autres.</p>
<h2>Serveur Nagios Core 4.x</h2>
<h3>Installation</h3>
<p>La version 4 de Nagios n'est pas actuellement dispo par APT, et l'installation du serveur (qui comprend le service et l'interface web de Nagios) passe donc par une phase de compilation puis d'installation depuis les sourcesÂ ?. Mais pas d'inquiÃ©tude tout a dÃ©jÃ  Ã©tÃ© scriptÃ© pour nous ?. Il suffit de suivre le <a href="https://support.nagios.com/kb/article/nagios-core-installing-nagios-core-from-source-96.html#Debian">guide officiel</a> qui nous guide pas Ã  pas en donnant la sÃ©quence de commandes Ã  taper pour installer Nagios4. L'install sur nos distributionsÂ  favorites Debian, Raspbian, Ubuntu est documentÃ© (Attention Ã  bien respecter les commandes pour votre version d'OS !)</p>
<p>VÃ©rifier l'installation de Nagios 4 cotÃ© serveur avec un sudo service nagios status</p>
<p>et vous pouvez dÃ©sormais accÃ©der Ã  l'interface web de Nagios visible sur <em>http://ip_de_votre_serveur_nagios/nagios</em></p>
<h3>Configuration</h3>
<p>Une fois le serveur installÃ©, il nous faut ajouter des <a href="https://assets.nagios.com/downloads/nagioscore/docs/nagioscore/3/en/configobject.html">objets</a> Ã  superviser, et Nagios distingue les Services et les HÃ´tes tout deux regroupable.</p>
<p>Les fichier de configurations sur ma distribution Ubuntu sont:</p>
<p>/usr/local/nagios/etc/nagios.cgf # fichier de configuration principal de Nagios (qui rÃ©fÃ©rence les autres fichiers de conf)</p>
<p>/usr/local/nagios/etc/objects/*.cfg # templates de fichiers de conf</p>
<p>j'ai dÃ©cidÃ© de dupliquer le fichier /usr/local/nagios/etc/objects/localhost.cfgÂ  en maconf.cfg j'ai remplacÃ© la ligne contenant localhost.cfg par la suivante dans nagios.cgf :</p>
<p>cfg_file=/usr/local/nagios/etc/objects/maconf.cfg</p>
<p>un petit test de la conf sudo service nagios reload -t et si tout va bien on reload le service (sans le -t).</p>
<h2>NRPE</h2>
<h3>cotÃ© sur Raspberry Pi</h3>
<p>Pour pouvoir effectuer des <strong>contrÃ´les plus poussÃ©s</strong> (CPU, mÃ©moire etc) ou mÃªme <strong>custom</strong>, il est utile de passer par un <strong>addon Nagios</strong> nommÃ© NRPE <a href="https://exchange.nagios.org/directory/Addons/Monitoring-Agents/NRPE--2D-Nagios-Remote-Plugin-Executor/details">?</a> qui sera a installer cotÃ© machine a surveiller (client):</p>
<p>sudo apt install nagios-nrpe-server</p>
<p>Il faudra ensuite <strong>ouvrir le port 5666 cotÃ© client</strong>, port utilisÃ© par nrpe serveur (oui oui c'est le serveur qui doit Ãªtre installÃ© sur la machine a surveiller) si nÃ©cessaire.</p>
<p>Editer le fichier de conf /etc/nagios/nrpe.cfgÂ en modifiant la ligne <strong>allowed_hosts</strong>=<em>adresse_ip_serveur_nagios</em> puis redÃ©marrer le service:</p>
<p>sudo service nagios-nrpe-server restart</p>
<p>le fichier de configÂ nrpe.cfg nous fourni dÃ©jÃ  plusieurs checks et aussi quelques autres que l'on peut dÃ©commenter :</p>
<p>command[check_users]=/usr/lib/nagios/plugins/check_users -w 5 -c 10
command[check_load]=/usr/lib/nagios/plugins/check_load -w 15,10,5 -c 30,25,20
command[check_hda1]=/usr/lib/nagios/plugins/check_disk -w 20% -c 10% -p /dev/hda1
command[check_zombie_procs]=/usr/lib/nagios/plugins/check_procs -w 5 -c 10 -s Z
command[check_total_procs]=/usr/lib/nagios/plugins/check_procs -w 150 -c 200</p>
<h3>cotÃ© serveur</h3>
<p>Il faut installer le plugin <strong>nagios-nrpe-plugin</strong> c'est l'outil qui va permettre Ã  Nagios serveur d'interroger les clients:</p>
<p>sudo apt install nagios-nrpe-plugin</p>
<p>Une fois le binaire installÃ© /usr/local/nagios/libexec/check_nrpeÂ , il possible d'effectuer un test en live:</p>
<p>check_nrpe -HÂ adresse_ip_machine_a_surveiller -c check_load</p>
<p>Pour finir, dÃ©finir la <em>commande</em> check_nrpe dans /usr/local/nagios/etc/objects/<strong>commands.cfg:</strong></p>
<p>define command {
command_name check_nrpe
command_line /usr/local/nagios/libexec/check_nrpe -H $HOSTADDRESS$ -c $ARG1$
}</p>
<p>pour la rendre disponible dans les fichiers de config /usr/local/nagios/etc/objects/maconf.cfg:</p>
<p>define service {
use generic-service
host_name ip_de_lobjet_reseau_a_surveiller
service_description CPU Load
check_command check_nrpe!check_load
notifications_enabled 0
}</p>
<h3>Troubleshooting et test de communication client/serveur</h3>
<ul>
<li>vÃ©rifier si le <strong>port 5666 est bien ouvert cotÃ© client</strong> avec un bon vieux <a href="https://www.digitalocean.com/community/tutorials/how-to-use-netcat-to-establish-and-test-tcp-and-udp-connections-on-a-vps">netcat</a> par exemple:
netcat -z -v -n 192.168.1.32 5666</li>
<li>vÃ©rifier que le <strong>service</strong> tourne bien cotÃ© client:
sudo service nagios-nrpe-server status</li>
<li>fichiers de log cotÃ© serveur:
tail /usr/local/nagios/var/nagios.log</li>
<li>vous trouverez la doc officiel de <a href="https://assets.nagios.com/downloads/nagioscore/docs/nagioscore/4/en/toc.html">Nagios Core 4.x</a> et du plugin NRPE en <a href="https://github.com/NagiosEnterprises/nrpe/blob/56492da4e4b55c8d188ed8114a88c18f0250ff55/docs/NRPE.pdf">pdf</a></li>
</ul>
<h2>Screenshot</h2>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 850px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/35396f816ee622db590acb07ceafe3b4/0c3d0/Nagios4.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 58.21596244131455%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAA7DAAAOwwHHb6hkAAACQUlEQVQoz52SO2/UQBSF/bvy01JEUKWhokAgQQESFUkBVAgKJIqkCKGIkrW99mYffr/Gj/WM17ubD80E0pCKka48V3fu8bnnHqtpGnSUZYlUCqUUUvas12v6vkcpiZLS5PJvrqSpdV1netM0pchyhBBY5+fneJ5HnmcsFguCYEWeF0gpqduGVRARhAl9LymqiiCICcOYqmrYbrcmhmGgbVvztfzZLV3XEoUhk4mNO/URomG33xFmAVfXNo7j0aueuNRvfK5vHLKs4LFj3c4DpFTUdUPTSkS9RqnNwwPNLM9zRCVom5aiKOi6tand3d39E9bU14ADZVlQVSVCVOx2OzbjhrZr6drW6KT1ua8Lk2utH2WYpKVB1kupKoE/m9MUHd+vP/P+53OciYM3nTJ1HMIgIE0T7MkE13HxPY84ismyjDiKkL3EWq4Sw6jv78dYBjFd0fPp8h2vLp7iuZ4B9FzXNGVpius4TF2Xyc2NuUdhRJ5lZpHWfJnSrZVZzDhumS9DmnzNt6sT3l4+w3c9w2TqOgZQN2oQx7YfgLWutRDGXlbbdUg1UNc1gxq4nS8owpKPZ6958+sYz/Hwfc80G4ZZivMHyLZtgtWKIs9NbPd7rDQrjMDaqFrLZRBRxYIPP17w8uKJGVkD6pG1tdIkeWB2O5uxmM9ZLZdEUcTp0RFWEJWM484YdBxH9A9E3nA2+cLX2QlJlJAksWFXVRVNUxtgE1FomOnN65GPDw40YMV2uzcu32w2DMPG3P/nnB4e8hu/iH41w39x8QAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Nagios4"
        title="Nagios4"
        src="/static/35396f816ee622db590acb07ceafe3b4/ae694/Nagios4.png"
        srcset="/static/35396f816ee622db590acb07ceafe3b4/3cb16/Nagios4.png 213w,
/static/35396f816ee622db590acb07ceafe3b4/2fbbf/Nagios4.png 425w,
/static/35396f816ee622db590acb07ceafe3b4/ae694/Nagios4.png 850w,
/static/35396f816ee622db590acb07ceafe3b4/3f20e/Nagios4.png 1275w,
/static/35396f816ee622db590acb07ceafe3b4/0c3d0/Nagios4.png 1414w"
        sizes="(max-width: 850px) 100vw, 850px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p></div><style data-emotion="css iw22na">.css-iw22na{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.75;letter-spacing:0.00938em;color:#90a4ae;}</style><i class="MuiTypography-root MuiTypography-subtitle1 css-iw22na"><div><span>rÃ©digÃ© le 31/08/18<!-- --> </span>par <!-- -->Behrouze</div></i></div></main><footer><style data-emotion="css 1cksea9">.css-1cksea9{border-top:1px solid #90a4ae;margin:2rem 0;padding:1.5rem 0;}@media (min-width:0px){.css-1cksea9{display:none;}}@media (min-width:600px){.css-1cksea9{display:block;}}</style><div class="MuiBox-root css-1cksea9"><style data-emotion="css 1hq69am">.css-1hq69am{-webkit-text-decoration:none;text-decoration:none;margin-right:2rem;}</style><style data-emotion="css 1l5ulo5">.css-1l5ulo5{margin:0;color:#37474f;-webkit-text-decoration:none;text-decoration:none;margin-right:2rem;}</style><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineNone css-1l5ulo5" href="/linux-systemd"></a><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineNone css-1l5ulo5" href="/a-propos-contact">A propos</a><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineNone css-1l5ulo5" href="/cheat-sheets">Cheat Sheets</a><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineNone css-1l5ulo5" href="/tools">Outils</a><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineNone css-1l5ulo5" href="/must-see-videos">VidÃ©os</a></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-29210389-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/nagios4";window.___webpackCompilationHash="c48d627d5b5c581d443c";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-14d23f0c9fb58e155a8c.js"],"app":["/app-2522e8ee87ba4c5fd227.js"],"component---src-pages-404-js":["/component---src-pages-404-js-73ec88530ccbc327b9bd.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-a4b09fa46789b3b434c2.js"],"component---src-templates-wp-page-tsx":["/component---src-templates-wp-page-tsx-d6427489a3af39d80c8a.js"],"component---src-templates-wp-post-tsx":["/component---src-templates-wp-post-tsx-f5cf34345488556083de.js"]};/*]]>*/</script><script src="/polyfill-14d23f0c9fb58e155a8c.js" nomodule=""></script><script src="/component---src-templates-wp-post-tsx-f5cf34345488556083de.js" async=""></script><script src="/bd9a198b5f7fb6fa7f93111e3cc9693331ac2819-9dc0a4f24174f9c3e8bd.js" async=""></script><script src="/commons-30350ba6450927006b33.js" async=""></script><script src="/app-2522e8ee87ba4c5fd227.js" async=""></script><script src="/framework-1b09f98392e3a984ace3.js" async=""></script><script src="/webpack-runtime-6c76308e3febb07c5cb7.js" async=""></script></body></html>