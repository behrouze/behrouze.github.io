<!DOCTYPE html><html lang="fr"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta data-react-helmet="true" name="msvalidate.01" content="A50293F74A3B85CC8957428EEEEAABA5"/><meta data-react-helmet="true" name="google-site-verification" content="kkqrNKWAArklwdQl9I2c0KZhhbL8Q8p4fVsYQkC4d_A"/><meta data-react-helmet="true" name="description" content="Blog technique et mÃ©mo sur les technos .Net et Javascript React ainsi que l&#x27;outillage devops"/><meta data-react-helmet="true" charSet="utf-8"/><meta name="generator" content="Gatsby 4.5.3"/><style data-href="/styles.0df1d067f0bf912eb593.css" data-identity="gatsby-global-css">code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#000;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-o-tab-size:4;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{margin:.5em 0;overflow:visible;padding:1px;position:relative}pre[class*=language-]>code{background-attachment:local;background-color:#fdfdfd;background-image:linear-gradient(transparent 50%,rgba(69,142,209,.04) 0);background-origin:content-box;background-size:3em 3em;border-left:10px solid #358ccb;box-shadow:-1px 0 0 0 #358ccb,0 0 0 1px #dfdfdf;position:relative;z-index:1}code[class*=language-]{display:block;height:inherit;max-height:inherit;overflow:auto;padding:0 1em}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdfdfd;box-sizing:border-box;margin-bottom:1em}:not(pre)>code[class*=language-]{border:1px solid rgba(0,0,0,.1);border-radius:.3em;color:#c92c2c;display:inline;padding:.2em;position:relative;white-space:normal}pre[class*=language-]:after,pre[class*=language-]:before{bottom:.75em;box-shadow:0 13px 8px #979797;content:"";display:block;height:20%;left:.18em;max-height:13em;position:absolute;-webkit-transform:rotate(-2deg);transform:rotate(-2deg);width:40%}pre[class*=language-]:after{left:auto;right:.75em;-webkit-transform:rotate(2deg);transform:rotate(2deg)}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#7d8b99}.token.punctuation{color:#5f6364}.token.boolean,.token.constant,.token.deleted,.token.function-name,.token.number,.token.property,.token.symbol,.token.tag{color:#c92c2c}.token.attr-name,.token.builtin,.token.char,.token.function,.token.inserted,.token.selector,.token.string{color:#2f9c0a}.token.entity,.token.operator,.token.url,.token.variable{background:hsla(0,0%,100%,.5);color:#a67f59}.token.atrule,.token.attr-value,.token.class-name,.token.keyword{color:#1990b8}.token.important,.token.regex{color:#e90}.language-css .token.string,.style .token.string{background:hsla(0,0%,100%,.5);color:#a67f59}.token.important{font-weight:400}.token.bold{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.namespace{opacity:.7}@media screen and (max-width:767px){pre[class*=language-]:after,pre[class*=language-]:before{bottom:14px;box-shadow:none}}pre[class*=language-].line-numbers.line-numbers{padding-left:0}pre[class*=language-].line-numbers.line-numbers code{padding-left:3.8em}pre[class*=language-].line-numbers.line-numbers .line-numbers-rows{left:0}pre[class*=language-][data-line]{padding-bottom:0;padding-left:0;padding-top:0}pre[data-line] code{padding-left:4em;position:relative}pre .line-highlight{margin-top:0}.heading{color:#639}ul.nav-links{display:flex;justify-content:space-between;list-style:none;padding-left:0}a{color:#1636b3;text-decoration:none}a:visited{color:#249899}h1{-webkit-text-fill-color:transparent;background:linear-gradient(90deg,#30cfd0 0,#330867);-webkit-background-clip:text;font-family:sans-serif;font-size:2rem;margin-bottom:0;text-transform:uppercase;transition:font-size .3s}h1.posts{-webkit-text-fill-color:transparent;background:linear-gradient(90deg,#164972 0,#041955);-webkit-background-clip:text;text-transform:none}h1.small{font-size:1.5rem}pre{background-color:#f5f6f8;overflow-x:scroll;padding:.3rem}blockquote{background-color:#f0f8ff;border-radius:5px;padding:.3rem 1rem}blockquote,img{box-shadow:0 4px 12px rgba(0,0,0,.1)}h1.posts::selection,h2::selection,h3::selection,h4::selection{background-color:#30cfd0}div::selection,li::selection,p::selection,span::selection{background-color:#fcf113}a::selection{background-color:#fcbe13}</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><title data-react-helmet="true">Next.js</title><link data-react-helmet="true" rel="canonical" href="https://blog.behrouze.com"/><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/><link rel="icon" href="/favicon-32x32.png?v=0ae59160d37d7dfca9356a20890d5111" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=0ae59160d37d7dfca9356a20890d5111"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=0ae59160d37d7dfca9356a20890d5111"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=0ae59160d37d7dfca9356a20890d5111"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=0ae59160d37d7dfca9356a20890d5111"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=0ae59160d37d7dfca9356a20890d5111"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=0ae59160d37d7dfca9356a20890d5111"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=0ae59160d37d7dfca9356a20890d5111"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=0ae59160d37d7dfca9356a20890d5111"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><script data-gatsby="web-vitals-polyfill">
            !function(){var e,t,n,i,r={passive:!0,capture:!0},a=new Date,o=function(){i=[],t=-1,e=null,f(addEventListener)},c=function(i,r){e||(e=r,t=i,n=new Date,f(removeEventListener),u())},u=function(){if(t>=0&&t<n-a){var r={entryType:"first-input",name:e.type,target:e.target,cancelable:e.cancelable,startTime:e.timeStamp,processingStart:e.timeStamp+t};i.forEach((function(e){e(r)})),i=[]}},s=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var n=function(){c(e,t),a()},i=function(){a()},a=function(){removeEventListener("pointerup",n,r),removeEventListener("pointercancel",i,r)};addEventListener("pointerup",n,r),addEventListener("pointercancel",i,r)}(t,e):c(t,e)}},f=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(t){return e(t,s,r)}))},p="hidden"===document.visibilityState?0:1/0;addEventListener("visibilitychange",(function e(t){"hidden"===document.visibilityState&&(p=t.timeStamp,removeEventListener("visibilitychange",e,!0))}),!0);o(),self.webVitals={firstInputPolyfill:function(e){i.push(e),u()},resetFirstInputPolyfill:o,get firstHiddenTime(){return p}}}();
          </script><link as="script" rel="preload" href="/webpack-runtime-4d8b553b20e84285ff64.js"/><link as="script" rel="preload" href="/framework-1b09f98392e3a984ace3.js"/><link as="script" rel="preload" href="/app-2522e8ee87ba4c5fd227.js"/><link as="script" rel="preload" href="/commons-30350ba6450927006b33.js"/><link as="script" rel="preload" href="/bd9a198b5f7fb6fa7f93111e3cc9693331ac2819-9dc0a4f24174f9c3e8bd.js"/><link as="script" rel="preload" href="/component---src-templates-wp-post-tsx-f5cf34345488556083de.js"/><link as="fetch" rel="preload" href="/page-data/next-js/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1026020893.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1333896537.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/28434099.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css-global o6gwfi">html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;box-sizing:border-box;-webkit-text-size-adjust:100%;}*,*::before,*::after{box-sizing:inherit;}strong,b{font-weight:700;}body{margin:0;color:rgba(0, 0, 0, 0.87);font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;background-color:#fff;}@media print{body{background-color:#fff;}}body::backdrop{background-color:#fff;}</style><style data-emotion="css 1c0cfyw">.css-1c0cfyw{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;display:block;padding-left:16px;padding-right:16px;}@media (min-width:600px){.css-1c0cfyw{padding-left:24px;padding-right:24px;}}@media (min-width:900px){.css-1c0cfyw{max-width:900px;}}</style><div class="MuiContainer-root MuiContainer-maxWidthMd css-1c0cfyw"><a href="/"><h1 class="small">DÃ©veloppeur FullStack &amp; Devops</h1></a><style data-emotion="css mtswq0">.css-mtswq0{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.75;letter-spacing:0.00938em;margin-bottom:0.35em;color:#78909c;}</style><div class="MuiTypography-root MuiTypography-subtitle1 MuiTypography-gutterBottom css-mtswq0">Notes et mÃ©mos techniques</div><main><div class="post-c0db99ee-09c9-5c47-b045-e93d6b14900f"><style data-emotion="css o3d33y">.css-o3d33y{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;color:rgba(0, 0, 0, 0.6);}</style><nav class="MuiTypography-root MuiTypography-body1 MuiBreadcrumbs-root css-o3d33y" aria-label="breadcrumb"><style data-emotion="css nhb8h9">.css-nhb8h9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0;margin:0;list-style:none;}</style><ol class="MuiBreadcrumbs-ol css-nhb8h9"><li class="MuiBreadcrumbs-li"><style data-emotion="css ajwvjb">.css-ajwvjb{-webkit-text-decoration:none;text-decoration:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><style data-emotion="css 15t9hkq">.css-15t9hkq{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.75;letter-spacing:0.00938em;color:#1976d2;-webkit-text-decoration:none;text-decoration:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><a class="MuiTypography-root MuiTypography-subtitle1 MuiLink-root MuiLink-underlineNone css-15t9hkq" href="/"><style data-emotion="css 5xigzu">.css-5xigzu{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:inherit;margin-right:4px;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeInherit css-5xigzu" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="HomeIcon"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"></path></svg></a></li><style data-emotion="css 3mf706">.css-3mf706{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin-left:8px;margin-right:8px;}</style><li aria-hidden="true" class="MuiBreadcrumbs-separator css-3mf706">/</li><li class="MuiBreadcrumbs-li"><style data-emotion="css ytumd6">.css-ytumd6{-webkit-text-decoration:none;text-decoration:none;}</style><style data-emotion="css 1fdfmag">.css-1fdfmag{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.75;letter-spacing:0.00938em;color:#1976d2;-webkit-text-decoration:none;text-decoration:none;}</style><a class="MuiTypography-root MuiTypography-subtitle1 MuiLink-root MuiLink-underlineNone css-1fdfmag" href="/?category=javascript">javascript</a></li><li aria-hidden="true" class="MuiBreadcrumbs-separator css-3mf706">/</li><li class="MuiBreadcrumbs-li"><style data-emotion="css 1vz2kpn">.css-1vz2kpn{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.75;letter-spacing:0.00938em;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><h6 class="MuiTypography-root MuiTypography-subtitle1 css-1vz2kpn">Next.js</h6></li></ol></nav><h1 class="posts">Next.js</h1><div><p><img src="Vercel_Nextjs_20220218111421.png" alt="">
<a href="https://nextjs.org">Next.js</a> est devenu le leader incontestÃ© ð des webapp React type SSR !
<a href="https://nextjs.org/blog/next-12">Next.js 12</a> Canary est la <a href="https://nextjs.org/blog">version</a> courante dÃ©veloppÃ©e et maintenue par des Ã©quipes de <a href="https://vercel.com/">Vercel</a> (ex <a href="https://www.theregister.com/2020/04/22/nextjs_vercel_logowatch/">Zeit</a>), la sociÃ©tÃ© qui a <a href="https://techcrunch.com/2021/06/23/vercel-raises-102m-series-c-for-its-next-js-based-front-end-development-platform">levÃ© 102$ million en 2021</a> pour accÃ©lÃ©rer les dÃ©veloppements.</p>
<p>D'un point de vue de dÃ©veloppeur, ce qui rend l'usage de <strong>Next.js intuitif</strong>, rÃ©side dans le fait le routage est une correspondance entre un <strong>fichier JavaScript</strong> et une <strong>URL</strong>, le fichier /pages/toto.js gÃ©nÃ©rera automatiquement l'URL <a href="http://monsite/toto">http://monsite/toto</a>, et ce modÃ¨le supporte le <a href="https://nextjs.org/docs/routing/dynamic-routes">routage dynamique</a> (avec des variables dans l'URL).</p>
<p>Next.js est donc LE standard en 2022, mais un sÃ©rieux concurrent commence a Ã©merger : <a href="https://remix.run/blog/remix-vs-next">Remix</a> ð¿, crÃ©Ã© par les concepteurs de <a href="https://www.flaco.dev/blog/what-is-react-remix">React Router</a> (<a href="https://reactresources.com/people/michael-jackson">Michael Jackson</a> &#x26; <a href="https://reactresources.com/people/ryan-florence">Ryan Florence</a> et rejoints depuis peu <a href="https://reactresources.com/people/kent-c-dodds">Kent C. Dodds</a>).
Ecouter une <a href="https://devtools.fm/episode/19">discussion des crÃ©ateurs de Remix</a> (podcast ð).</p>
<h2>IntÃ©rÃªts de Next.js</h2>
<p>Les intÃ©rÃªts de Next.js par rapport Ã  une solution classique Ã  base d'API Back + React en front sont :</p>
<ul>
<li>supporte diffÃ©rentes <a href="https://nextjs.org/docs/basic-features/data-fetching/overview">mÃ©thodes de rendu de pages</a> (SSR, SSG et CSR) permettant d'optimiser le SEO. Le SSR est ce qui a fait le succÃ¨s ð¥ de Next.js.</li>
<li>utilise un <strong>routage</strong> (routing) trÃ¨s intuitif et <a href="https://nextjs.org/docs/routing/dynamic-routes">dynamique</a></li>
<li>support de <a href="https://nextjs.org/docs/basic-features/supported-browsers-features#javascript-language-features">> ES6</a> ainsi que <a href="https://nextjs.org/docs/basic-features/typescript">typescript</a></li>
<li><a href="https://nextjs.org/docs/upgrading">guides d'upgrade</a> assez clean pour migrer de version de Next.js et un <a href="https://nextjs.org/docs/advanced-features/codemods">codemod</a> est Ã©galement disponible pour automatiser en partie les migrations</li>
<li><strong>learning curve</strong> plutot raide pour les <em>dÃ©veloppeurs React</em> avec une prise en main rapide grÃ¢ce Ã  leurs super <a href="https://nextjs.org/learn/basics/create-nextjs-app">tutos</a> ð</li>
</ul>
<h2>Routing</h2>
<h3>Pages</h3>
<p>Une <strong>URL</strong> est <strong>crÃ©e</strong> <strong>automatiquement</strong> dÃ¨s qu'on dÃ©pose un <strong>fichier JS</strong> ou <strong>JSX</strong> dans le dossier <code class="language-text">/pages/</code> (par <strong>convention</strong>).
De plus Next.js supporte:</p>
<ul>
<li>les <a href="https://nextjs.org/docs/routing/introduction#nested-routes">nested routes</a> : l'URL <code class="language-text">pages/toto/titi/tutu</code> sera routÃ©e vers le fichier <code class="language-text">tutu.jsx</code> <code class="language-text">pages/toto/titi/tutu.jsx</code></li>
<li>les <a href="https://nextjs.org/docs/routing/introduction#index-routes">Index routes</a> : l'URL <code class="language-text">pages/toto/titi/tutu</code>  sera routÃ©e vers le fichier <code class="language-text">index</code> suivant : <code class="language-text">pages/toto/titi/tutu/index.jsx</code></li>
<li>les routes dynamiques (<a href="https://nextjs.org/blog/next-9#dynamic-route-segments">depuis v9</a>) : utilisation d'une variable d'URL <code class="language-text">/:toto</code>  pour etre routÃ© vers <code class="language-text">/[toto].js</code> (valable pour les dossiers aussi), et de <a href="https://nextjs.org/docs/routing/dynamic-routes#catch-all-routes">catch all routes</a> <code class="language-text">/[...toto].js</code></li>
</ul>
<h3>API</h3>
<p>Il est possible depuis Next.js 10 de crÃ©er des <a href="https://nextjs.org/docs/api-routes/introduction">API dans Next.js</a>, <code class="language-text">pages/api</code> sera mappÃ© Ã  <code class="language-text">/api/*</code>.</p>
<p>â  Attention, cette solution est plutot limitÃ©s comparÃ©e Ã  des solutions robustes et pleines de fonctionnalitÃ©s comme <a href="https://docs.nestjs.com/">NestJS</a>.
D'aprÃ¨s la doc le <a href="https://nextjs.org/docs/api-routes/introduction#use-cases">use case typique d'une API Next.js</a> est de jouer un role de <strong>Proxy</strong> soit pour masquer des URL internes, soit pour utiliser des variables d'environements.
J'ajouterai que c'est un trÃ¨s bon moyen de <a href="https://www.manager-go.com/gestion-de-projet/poc.htm">POC</a>er ð !</p>
<h3>Public</h3>
<p>Pour les <strong>Ã©lÃ©ments statiques</strong> (images, css, <code class="language-text">robots.txt</code>, <code class="language-text">favicon.ico</code>, et autres) il existe le dossier <code class="language-text">/public/</code> (anciennement <code class="language-text">/static/</code>) rÃ©servÃ© a cet effet.</p>
<h3>Cycle de vie du Router</h3>
<p>Le Router de Next.js propose un ensemble d'Ã©vÃ¨nements qu'il est possible d'Ã©couter :</p>
<ul>
<li><strong>route</strong>ChangeStart(url)</li>
<li><strong>route</strong>ChangeComplete(url)</li>
<li><strong>route</strong>ChangeError(err, url)</li>
<li>before<strong>History</strong>Change(url)</li>
<li><strong>hash</strong>ChangeStart(url)</li>
<li><strong>hash</strong>ChangeComplete(url)</li>
</ul>
<h3>Navigation</h3>
<p>La navigation est simplifiÃ©e par l'usage de :</p>
<ul>
<li>
<p>composants Next.js <a href="https://nextjs.org/docs/api-reference/next/link">Link</a> du package <code class="language-text">next/link</code></p>
</li>
<li>
<p>un routage <a href="https://github.com/zeit/next.js#imperatively">imperatif</a> grÃ¢ce au hook <code class="language-text">useRouter</code> du package <code class="language-text">next/router</code>  qui nous retourne un <a href="https://nextjs.org/docs/api-reference/next/router#router-object">objet <code class="language-text">router</code></a> auxquels on peut associer l'<a href="https://nodejs.org/api/url.html#url_url_strings_and_url_objects">objet URL</a> et par exemple pour la fonction <code class="language-text">router.push</code> on a les <a href="https://nextjs.org/docs/api-reference/next/router#routerpush">arguments</a> :</p>
<ul>
<li>la prop <strong>href</strong> permet au framework de faire le lien entre l'URL et les fichiers JS contenu dans le dossier pages</li>
<li>la prop <strong>as</strong> permet de crÃ©er et d'<strong>afficher dans le HTML rÃ©sultant</strong> un <em>href alias</em> (ici le lien pointera vers /p/xxx), qu'il faudra traitÃ© cotÃ© back (mÃ©thode render de l'API next).</li>
</ul>
</li>
<li>
<p>le <a href="https://nextjs.org/docs/routing/shallow-routing">shallow routing</a> qui consiste Ã  ne pas avoir a charger une nouvelle fois la page et byepasser toutes les mÃ©thodes de data fetching (<a href="https://nextjs.org/docs/basic-features/data-fetching/get-server-side-props"><code class="language-text">getServerSideProps</code></a>, <a href="https://nextjs.org/docs/basic-features/data-fetching/get-static-props"><code class="language-text">getStaticProps</code></a>, et <a href="https://nextjs.org/docs/api-reference/data-fetching/get-initial-props"><code class="language-text">getInitialProps</code></a>) si on navigue sur la <strong>meme page</strong>.</p>
</li>
</ul>
<h2>Data fetching</h2>
<h3>mÃ©thode getInitialProps</h3>
<p>Avec Next.js, on utilise la <strong>mÃ©thode statique</strong> <a href="https://github.com/zeit/next.js#fetching-data-and-component-lifecycle">getInitialProps</a> qui permet comme son nom l'indique, de charger les props du composant avec le rÃ©sultat de la requÃªte Ajax. Il est possible d'utiliser cette mÃ©thode de 2 faÃ§ons:</p>
<ul>
<li>soit dans un <strong>composant React</strong> (qui possÃ¨de donc un lifecyle), en dÃ©finissant cette mÃ©thode:
<code class="language-text">static async getInitialProps({ req }) {....</code></li>
<li>soit en dÃ©finissant un lifecycle methode pris en charge par le framework Nexjs, pour un composant stateless (ici nommÃ© MaPage):
<code class="language-text">MaPage.getInitialProps = async ({ req }) => {</code></li>
</ul>
<h3>propriÃ©tÃ©s de l'objet context</h3>
<p>La mÃ©thode <strong>getInitialProps</strong> reÃ§oit en <strong>paramÃ¨tre</strong> un **objet contextÂ ** (paramÃ¨tre <em>req</em> dans les 2 ex ci-dessus) qui contient les informations de routage:</p>
<ul>
<li><strong>pathname</strong> - chemin next (correspondant au fichier js)</li>
<li><strong>asPath</strong> - URL complÃ¨te telle que visible dans le navigateur <strong>incluant la query string</strong></li>
<li><strong>query</strong> - <strong>query string</strong> de l'URL parsÃ© dans un objet</li>
<li><strong>req</strong> - objet <strong>request</strong> HTTP (serveur uniquement)</li>
<li><strong>res</strong> - objet <strong>response</strong> HTTP (serveur uniquement)</li>
<li><strong>jsonPageRes</strong> -Â objet <a href="https://developer.mozilla.org/en-US/docs/Web/API/Response">Fetch Response</a> (client uniquement)</li>
<li><strong>err</strong> - objet Error si une erreur intervient lors du render</li>
</ul>
<h2>Styling</h2>
<h3>CSS-in-JS avec styled-jsx</h3>
<p>Next.js a fait le <a href="https://nextjs.org/docs/basic-features/built-in-css-support#css-in-js">choix</a> d'embarquer <strong><a href="https://github.com/zeit/styled-jsx#styled-jsx">styled-jsx</a></strong> qui est une des solution CSS-in-JS mais il existe de <a href="http://michelebertoli.github.io/css-in-js/">nombreuses solutions</a> qu'il est possible d'utiliser avec Next.js (<em>Styled Components</em> ou <em>Emotion</em>), voir des exemples d'utilisations dans <a href="https://nextjs.org/docs/basic-features/built-in-css-support#css-in-js">cette section exemple</a>.</p>
<p>Le CSS-in-JS permet d'avoir des styles scopÃ©s au niveau du composant, des styles dynamiques fonction du code, et surtout d'appliquer les styles lors du rendu cotÃ© serveur.</p>
<p>L'utilisation est encore une fois trÃ¨s intuitive, car il suffit d'Ã©crire ses styles directement dans des balises <code class="language-text">&lt;style jsx></code>Â  Ã  lâintÃ©rieur de ses composants en utilisant la syntaxe <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals">template strings</a>:</p>
<style global jsx>{`
    h1, a {
    font-family: "Arial";
  }
`}</style>
<h3>CSS classique</h3>
<p>Il est recommandÃ© d'utiliser styled-jsx pour le styling, il est cependant possible d'<a href="https://github.com/zeit/next.js#importing-css--sass--less--stylus-files">importer du CSS, SASS, LESS ou Stylus</a> grÃ¢ce Ã  des plugins Next.</p>
<p>De plus si on souhaite utiliser une <strong>bibliothÃ¨que CSS</strong>, <em>styled-jsx va automatiquement prefixer les noms de classe</em> dans le HTML rendu, ce crÃ©era des interferences.<br>
On peut Ã©viter cela en utilisant l'attribut <strong>optionCLassName</strong> au lieu du classique <strong>class</strong>.</p>
<p><code class="language-text">&lt;Select optionClassName="react-select" /></code></p>
<h2>Squelettes de projets Next.JS</h2>
<p>Un outil sympathique, qui fourni un squelette de projet Next.js/React/Redux est <a href="https://github.com/segmentio/create-next-app/blob/master/README.md">create-next-app</a>, parfait pour voir rapidement les branchements entre ces outils :)</p>
Concernant <a href="/materialui-react" title="Material UI">Material UI</a>, il y a un exemple de projet Nexjs/MaterialUI ainsi qu'une doc SSR Material UI.
<h2>Divers et DX</h2>
<h3>Appels Ajax</h3>
<p>Support de <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API">fetch</a> par polyfill cotÃ© navigateur (depuis Next.js 9.1.7), et <a href="https://nextjs.org/blog/next-9-4#improved-built-in-fetch-support">cotÃ© Nodejs(depuis Nexjs 9.4)</a>.
Nous pouvons donc simplement utiliser fetch() partout dans notre code.</p>
<h3>Variable d'environnements</h3>
<p><a href="https://nextjs.org/blog/next-9-4#new-environment-variables-support">Next 9.4</a> a simplifiÃ© et clarifiÃ© l'usage des <a href="https://nextjs.org/docs/basic-features/environment-variables">variable d'environnements</a> avec :</p>
<ul>
<li>le support des fichiers <a href="https://nextjs.org/docs/basic-features/environment-variables">.env</a></li>
<li>par dÃ©faut les vars d'env sont disponible uniquement cotÃ© serveur, mais s'ils sont prefixÃ©s par <code class="language-text">NEXT_PUBLIC_</code> il sont Ã©galement disponibles dans le navigateur (plus besoin d'utiliser le <code class="language-text">next.config.js</code> pour y dÃ©finir les vars)</li>
</ul>
<h3>Chemins absolu pour les imports and aliases</h3>
<p>Toujours depuis la <a href="https://nextjs.org/blog/next-9-4#absolute-imports-and-aliases">9.4</a> Next.js supporte dÃ©sormais la personnalisation des chemins d'imports de modules dans le <a href="https://code.visualstudio.com/docs/languages/jsconfig#_jsconfig-options"><code class="language-text">jsconfig.json</code> (JS projects)</a> ou le <a href="https://www.typescriptlang.org/docs/handbook/module-resolution.html#base-url"><code class="language-text">tsconfig.json</code> (TS projects)</a> :</p>
<ul>
<li>les <strong>chemins absolu</strong> en ajoutant la clÃ© <code class="language-text"> "baseUrl": "."</code> .</li>
<li>les <strong>alias de modules</strong> en ajoutant la clÃ© <code class="language-text">"paths": {"@/design-system/*": ["components/design-system/*"]}</code></li>
</ul>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token comment">// tsconfig.json ou jsconfig.json</span>
<span class="token punctuation">{</span>
  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"baseUrl"</span><span class="token operator">:</span> <span class="token string">"."</span><span class="token punctuation">,</span>
    <span class="token property">"paths"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"@/design-system/*"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"components/design-system/*"</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<h3>Debugging</h3>
<p>La doc Next.js nous fourni (et c'est plutot rare pour le souligner) le <code class="language-text">.vscode/launch.json</code> qui est la <a href="https://nextjs.org/docs/advanced-features/debugging#debugging-with-vs-code">config de VSCode pour debugger un projet Next.js</a> ðð¥³ ð.
Elle est un peu particuliÃ¨re parcequ'il faut pouvoir debugger cotÃ© client et serveur :</p>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"0.2.0"</span><span class="token punctuation">,</span>
  <span class="token property">"configurations"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Next.js: debug server-side"</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"node-terminal"</span><span class="token punctuation">,</span>
      <span class="token property">"request"</span><span class="token operator">:</span> <span class="token string">"launch"</span><span class="token punctuation">,</span>
      <span class="token property">"command"</span><span class="token operator">:</span> <span class="token string">"npm run dev"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Next.js: debug client-side"</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"pwa-chrome"</span><span class="token punctuation">,</span>
      <span class="token property">"request"</span><span class="token operator">:</span> <span class="token string">"launch"</span><span class="token punctuation">,</span>
      <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"http://localhost:3000"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Next.js: debug full stack"</span><span class="token punctuation">,</span>
      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"node-terminal"</span><span class="token punctuation">,</span>
      <span class="token property">"request"</span><span class="token operator">:</span> <span class="token string">"launch"</span><span class="token punctuation">,</span>
      <span class="token property">"command"</span><span class="token operator">:</span> <span class="token string">"npm run dev"</span><span class="token punctuation">,</span>
      <span class="token property">"console"</span><span class="token operator">:</span> <span class="token string">"integratedTerminal"</span><span class="token punctuation">,</span>
      <span class="token property">"serverReadyAction"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"pattern"</span><span class="token operator">:</span> <span class="token string">"started server on .+, url: (https?://.+)"</span><span class="token punctuation">,</span>
        <span class="token property">"uriFormat"</span><span class="token operator">:</span> <span class="token string">"%s"</span><span class="token punctuation">,</span>
        <span class="token property">"action"</span><span class="token operator">:</span> <span class="token string">"debugWithChrome"</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre></div></div><style data-emotion="css iw22na">.css-iw22na{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.75;letter-spacing:0.00938em;color:#90a4ae;}</style><i class="MuiTypography-root MuiTypography-subtitle1 css-iw22na"><div><span>rÃ©digÃ© le 02/10/18<!-- --> </span><span>, <!-- -->maj le 18/02/22<!-- --> </span>par <!-- -->Behrouze</div></i></div></main><footer><style data-emotion="css 1cksea9">.css-1cksea9{border-top:1px solid #90a4ae;margin:2rem 0;padding:1.5rem 0;}@media (min-width:0px){.css-1cksea9{display:none;}}@media (min-width:600px){.css-1cksea9{display:block;}}</style><div class="MuiBox-root css-1cksea9"><style data-emotion="css 1hq69am">.css-1hq69am{-webkit-text-decoration:none;text-decoration:none;margin-right:2rem;}</style><style data-emotion="css 1l5ulo5">.css-1l5ulo5{margin:0;color:#37474f;-webkit-text-decoration:none;text-decoration:none;margin-right:2rem;}</style><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineNone css-1l5ulo5" href="/linux-systemd"></a><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineNone css-1l5ulo5" href="/a-propos-contact">A propos</a><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineNone css-1l5ulo5" href="/cheat-sheets">Cheat Sheets</a><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineNone css-1l5ulo5" href="/tools">Outils</a><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineNone css-1l5ulo5" href="/must-see-videos">VidÃ©os</a></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-29210389-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/next-js";window.___webpackCompilationHash="affcf9badc643c34ff96";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-14d23f0c9fb58e155a8c.js"],"app":["/app-2522e8ee87ba4c5fd227.js"],"component---src-pages-404-js":["/component---src-pages-404-js-73ec88530ccbc327b9bd.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-a4b09fa46789b3b434c2.js"],"component---src-templates-wp-page-tsx":["/component---src-templates-wp-page-tsx-d6427489a3af39d80c8a.js"],"component---src-templates-wp-post-tsx":["/component---src-templates-wp-post-tsx-f5cf34345488556083de.js"]};/*]]>*/</script><script src="/polyfill-14d23f0c9fb58e155a8c.js" nomodule=""></script><script src="/component---src-templates-wp-post-tsx-f5cf34345488556083de.js" async=""></script><script src="/bd9a198b5f7fb6fa7f93111e3cc9693331ac2819-9dc0a4f24174f9c3e8bd.js" async=""></script><script src="/commons-30350ba6450927006b33.js" async=""></script><script src="/app-2522e8ee87ba4c5fd227.js" async=""></script><script src="/framework-1b09f98392e3a984ace3.js" async=""></script><script src="/webpack-runtime-4d8b553b20e84285ff64.js" async=""></script></body></html>