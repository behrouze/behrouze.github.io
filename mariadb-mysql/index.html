<!DOCTYPE html><html lang="fr"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta data-react-helmet="true" name="msvalidate.01" content="A50293F74A3B85CC8957428EEEEAABA5"/><meta data-react-helmet="true" name="google-site-verification" content="kkqrNKWAArklwdQl9I2c0KZhhbL8Q8p4fVsYQkC4d_A"/><meta data-react-helmet="true" name="description" content="Blog technique et mÃ©mo sur les technos .Net et Javascript React ainsi que l&#x27;outillage devops"/><meta data-react-helmet="true" charSet="utf-8"/><meta name="generator" content="Gatsby 4.5.3"/><style data-href="/styles.2618d1cb11661a373719.css" data-identity="gatsby-global-css">code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#000;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-o-tab-size:4;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{margin:.5em 0;overflow:visible;padding:1px;position:relative}pre[class*=language-]>code{background-attachment:local;background-color:#fdfdfd;background-image:linear-gradient(transparent 50%,rgba(69,142,209,.04) 0);background-origin:content-box;background-size:3em 3em;border-left:10px solid #358ccb;box-shadow:-1px 0 0 0 #358ccb,0 0 0 1px #dfdfdf;position:relative;z-index:1}code[class*=language-]{display:block;height:inherit;max-height:inherit;overflow:auto;padding:0 1em}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdfdfd;box-sizing:border-box;margin-bottom:1em}:not(pre)>code[class*=language-]{border:1px solid rgba(0,0,0,.1);border-radius:.3em;color:#c92c2c;display:inline;padding:.2em;position:relative;white-space:normal}pre[class*=language-]:after,pre[class*=language-]:before{bottom:.75em;box-shadow:0 13px 8px #979797;content:"";display:block;height:20%;left:.18em;max-height:13em;position:absolute;-webkit-transform:rotate(-2deg);transform:rotate(-2deg);width:40%}pre[class*=language-]:after{left:auto;right:.75em;-webkit-transform:rotate(2deg);transform:rotate(2deg)}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#7d8b99}.token.punctuation{color:#5f6364}.token.boolean,.token.constant,.token.deleted,.token.function-name,.token.number,.token.property,.token.symbol,.token.tag{color:#c92c2c}.token.attr-name,.token.builtin,.token.char,.token.function,.token.inserted,.token.selector,.token.string{color:#2f9c0a}.token.entity,.token.operator,.token.url,.token.variable{background:hsla(0,0%,100%,.5);color:#a67f59}.token.atrule,.token.attr-value,.token.class-name,.token.keyword{color:#1990b8}.token.important,.token.regex{color:#e90}.language-css .token.string,.style .token.string{background:hsla(0,0%,100%,.5);color:#a67f59}.token.important{font-weight:400}.token.bold{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.namespace{opacity:.7}@media screen and (max-width:767px){pre[class*=language-]:after,pre[class*=language-]:before{bottom:14px;box-shadow:none}}pre[class*=language-].line-numbers.line-numbers{padding-left:0}pre[class*=language-].line-numbers.line-numbers code{padding-left:3.8em}pre[class*=language-].line-numbers.line-numbers .line-numbers-rows{left:0}pre[class*=language-][data-line]{padding-bottom:0;padding-left:0;padding-top:0}pre[data-line] code{padding-left:4em;position:relative}pre .line-highlight{margin-top:0}.heading{color:#639}ul.nav-links{display:flex;justify-content:space-between;list-style:none;padding-left:0}a{color:#1636b3;text-decoration:none}a:visited{color:#0f5a70}h1{-webkit-text-fill-color:transparent;background:linear-gradient(90deg,#30cfd0 0,#330867);-webkit-background-clip:text;font-family:sans-serif;font-size:2rem;margin-bottom:0;text-transform:uppercase;transition:font-size .3s}h1.posts{-webkit-text-fill-color:transparent;background:linear-gradient(90deg,#2779bd 0,#041955);-webkit-background-clip:text;text-transform:none}h1.small{font-size:1.5rem}pre{background-color:#f5f6f8;overflow-x:scroll;padding:.3rem}blockquote{background-color:#f0f8ff;border-radius:5px;padding:.3rem 1rem}blockquote,img{box-shadow:0 4px 12px rgba(0,0,0,.1)}h1.posts::selection,h2::selection,h3::selection,h4::selection{background-color:#30cfd0}::selection{background-color:#fcf113}a::selection{background-color:#fcbe13}</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><title data-react-helmet="true">MariaDB MySQL</title><link data-react-helmet="true" rel="canonical" href="https://blog.behrouze.com"/><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/><link rel="icon" href="/favicon-32x32.png?v=0ae59160d37d7dfca9356a20890d5111" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=0ae59160d37d7dfca9356a20890d5111"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=0ae59160d37d7dfca9356a20890d5111"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=0ae59160d37d7dfca9356a20890d5111"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=0ae59160d37d7dfca9356a20890d5111"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=0ae59160d37d7dfca9356a20890d5111"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=0ae59160d37d7dfca9356a20890d5111"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=0ae59160d37d7dfca9356a20890d5111"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=0ae59160d37d7dfca9356a20890d5111"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><script data-gatsby="web-vitals-polyfill">
            !function(){var e,t,n,i,r={passive:!0,capture:!0},a=new Date,o=function(){i=[],t=-1,e=null,f(addEventListener)},c=function(i,r){e||(e=r,t=i,n=new Date,f(removeEventListener),u())},u=function(){if(t>=0&&t<n-a){var r={entryType:"first-input",name:e.type,target:e.target,cancelable:e.cancelable,startTime:e.timeStamp,processingStart:e.timeStamp+t};i.forEach((function(e){e(r)})),i=[]}},s=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var n=function(){c(e,t),a()},i=function(){a()},a=function(){removeEventListener("pointerup",n,r),removeEventListener("pointercancel",i,r)};addEventListener("pointerup",n,r),addEventListener("pointercancel",i,r)}(t,e):c(t,e)}},f=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(t){return e(t,s,r)}))},p="hidden"===document.visibilityState?0:1/0;addEventListener("visibilitychange",(function e(t){"hidden"===document.visibilityState&&(p=t.timeStamp,removeEventListener("visibilitychange",e,!0))}),!0);o(),self.webVitals={firstInputPolyfill:function(e){i.push(e),u()},resetFirstInputPolyfill:o,get firstHiddenTime(){return p}}}();
          </script><link as="script" rel="preload" href="/webpack-runtime-7d20d3cba42a18af62c0.js"/><link as="script" rel="preload" href="/framework-1b09f98392e3a984ace3.js"/><link as="script" rel="preload" href="/app-2522e8ee87ba4c5fd227.js"/><link as="script" rel="preload" href="/commons-30350ba6450927006b33.js"/><link as="script" rel="preload" href="/bd9a198b5f7fb6fa7f93111e3cc9693331ac2819-5c4a823133b536a699d8.js"/><link as="script" rel="preload" href="/component---src-templates-wp-post-tsx-6bbc10329ef005f8184a.js"/><link as="fetch" rel="preload" href="/page-data/mariadb-mysql/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1026020893.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/28434099.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3153813225.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css-global o6gwfi">html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;box-sizing:border-box;-webkit-text-size-adjust:100%;}*,*::before,*::after{box-sizing:inherit;}strong,b{font-weight:700;}body{margin:0;color:rgba(0, 0, 0, 0.87);font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;background-color:#fff;}@media print{body{background-color:#fff;}}body::backdrop{background-color:#fff;}</style><style data-emotion="css 1c0cfyw">.css-1c0cfyw{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;display:block;padding-left:16px;padding-right:16px;}@media (min-width:600px){.css-1c0cfyw{padding-left:24px;padding-right:24px;}}@media (min-width:900px){.css-1c0cfyw{max-width:900px;}}</style><main class="MuiContainer-root MuiContainer-maxWidthMd css-1c0cfyw"><a href="/"><style data-emotion="css pbhgh7">.css-pbhgh7{margin:0;font-size:2rem;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:300;line-height:1.167;letter-spacing:-0.01562em;margin-bottom:0.35em;}</style><h1 class="MuiTypography-root MuiTypography-h1 MuiTypography-gutterBottom small css-pbhgh7">DÃ©veloppeur FullStack &amp; Devops</h1></a><style data-emotion="css 1xkti9d">.css-1xkti9d{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.75;letter-spacing:0.00938em;margin-bottom:0.35em;color:#546e7a;}</style><h6 class="MuiTypography-root MuiTypography-subtitle1 MuiTypography-gutterBottom css-1xkti9d">Notes et mÃ©mos techniques</h6><main><div class="post-4dd64e67-f5c1-5375-88b5-56b74bb8bc7e"><style data-emotion="css o3d33y">.css-o3d33y{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;color:rgba(0, 0, 0, 0.6);}</style><nav class="MuiTypography-root MuiTypography-body1 MuiBreadcrumbs-root css-o3d33y" aria-label="breadcrumb"><style data-emotion="css nhb8h9">.css-nhb8h9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0;margin:0;list-style:none;}</style><ol class="MuiBreadcrumbs-ol css-nhb8h9"><li class="MuiBreadcrumbs-li"><style data-emotion="css ajwvjb">.css-ajwvjb{-webkit-text-decoration:none;text-decoration:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><style data-emotion="css 15t9hkq">.css-15t9hkq{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.75;letter-spacing:0.00938em;color:#1976d2;-webkit-text-decoration:none;text-decoration:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><a class="MuiTypography-root MuiTypography-subtitle1 MuiLink-root MuiLink-underlineNone css-15t9hkq" href="/"><style data-emotion="css 5xigzu">.css-5xigzu{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:inherit;margin-right:4px;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeInherit css-5xigzu" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="HomeIcon"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"></path></svg></a></li><style data-emotion="css 3mf706">.css-3mf706{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin-left:8px;margin-right:8px;}</style><li aria-hidden="true" class="MuiBreadcrumbs-separator css-3mf706">/</li><li class="MuiBreadcrumbs-li"><style data-emotion="css ytumd6">.css-ytumd6{-webkit-text-decoration:none;text-decoration:none;}</style><style data-emotion="css 1fdfmag">.css-1fdfmag{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.75;letter-spacing:0.00938em;color:#1976d2;-webkit-text-decoration:none;text-decoration:none;}</style><a class="MuiTypography-root MuiTypography-subtitle1 MuiLink-root MuiLink-underlineNone css-1fdfmag" href="/?category="></a></li><li aria-hidden="true" class="MuiBreadcrumbs-separator css-3mf706">/</li><li class="MuiBreadcrumbs-li"><style data-emotion="css 1vz2kpn">.css-1vz2kpn{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.75;letter-spacing:0.00938em;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><h6 class="MuiTypography-root MuiTypography-subtitle1 css-1vz2kpn">MariaDB MySQL</h6></li></ol></nav><h1 class="posts">MariaDB MySQL</h1><div><h2>Use DB ou prefixe</h2>
<h3>Use</h3>
<p>Pour utiliser une table il est possible de se placer sur la DB souhaitÃ©e avec <code class="language-text">USE xxx;</code> puis executer les commandes dessus :</p>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">USE</span> mysql<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token keyword">user</span> <span class="token keyword">FROM</span> <span class="token keyword">user</span><span class="token punctuation">;</span></code></pre></div>
<p>L'interet de cette syntaxe, est qu'en mode interactif, cela nous Ã©vite de tapper le prÃ©fixe Ã  chaque commande pour une succession de commandes concernant la meme table.</p>
<h3>Prefixe</h3>
<p>il est possible de prefixer le nom des tables par le nom de la base :</p>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">user</span> <span class="token keyword">FROM</span> mysql<span class="token punctuation">.</span><span class="token keyword">user</span><span class="token punctuation">;</span></code></pre></div>
<p>L'interet de cette seconde syntaxe est qu'elle est plus rapide pour exÃ©cuter 1 seule commtande sur une autre table comme ci-dessus sur une table systÃ¨me.</p>
<h2>Afficher des infos</h2>
<h3>SchÃ©ma BDD</h3>
<p>Les 3 commandes suivantes sont Ã©quivalente pour obtenir les schÃ©ma de la BDD courante:</p>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">SHOW</span> <span class="token keyword">DATABASES</span><span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> SCHEMAS<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> schema_name <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span>schemata<span class="token punctuation">;</span></code></pre></div>
<p>attention si l'option <code class="language-text">--skip-show-database</code> a Ã©tÃ© utilisÃ© pour lancer le serveur, aucune info ne sera retournÃ©e Ã  moins d'avoir le privilege <code class="language-text">SHOW DATABASES</code>.</p>
<h4>Filtrer</h4>
<p>Pour affiner les recherches utliser l'opÃ©rateur <code class="language-text">LIKE</code> :</p>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">SHOW</span> <span class="token keyword">DATABASES</span> <span class="token operator">LIKE</span> <span class="token string">"wp%"</span><span class="token punctuation">;</span></code></pre></div>
<h3>Tables</h3>
<p>Pour lister les tables</p>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">SHOW</span> <span class="token keyword">TABLES</span><span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> <span class="token keyword">FULL</span> <span class="token keyword">TABLES</span><span class="token punctuation">;</span>  <span class="token comment">--montre le table_type "BASE TABLE" ou "VIEW"</span></code></pre></div>
<p>Filtrer avec <code class="language-text">LIKE</code> ou <code class="language-text">WHERE</code> :</p>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">SHOW</span> <span class="token keyword">FULL</span> <span class="token keyword">TABLES</span> <span class="token keyword">WHERE</span> table_type <span class="token operator">=</span> <span class="token string">'VIEW'</span><span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> <span class="token keyword">FULL</span> <span class="token keyword">TABLES</span> <span class="token operator">LIKE</span> <span class="token string">"%post%"</span><span class="token punctuation">;</span></code></pre></div>
<p>Pour avoir des infos sur la structure d'une table</p>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">DESC</span> mysql<span class="token punctuation">.</span><span class="token keyword">user</span><span class="token punctuation">;</span>
<span class="token keyword">DESCRIBE</span> mysql<span class="token punctuation">.</span><span class="token keyword">user</span><span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> <span class="token keyword">COLUMNS</span> <span class="token keyword">FROM</span> mysql<span class="token punctuation">.</span><span class="token keyword">user</span><span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> <span class="token keyword">FULL</span> <span class="token keyword">COLUMNS</span> <span class="token keyword">FROM</span> mysql<span class="token punctuation">.</span><span class="token keyword">user</span><span class="token punctuation">;</span></code></pre></div>
<p>Le mot clÃ© FULL ajoute les champs <code class="language-text">collation</code>, <code class="language-text">privileges</code> et <code class="language-text">comment</code></p>
<h4>Filtrer</h4>
<p>Filtrer <code class="language-text">SHOW [FULL] COLUMNS</code> avec <code class="language-text">LIKE</code> ou <code class="language-text">WHERE</code> :</p>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">SHOW</span> <span class="token keyword">COLUMNS</span> <span class="token keyword">FROM</span> wp_blog_behrouze<span class="token punctuation">.</span>wp_posts <span class="token operator">LIKE</span> <span class="token string">"post%"</span><span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> <span class="token keyword">COLUMNS</span> <span class="token keyword">FROM</span> wp_blog_behrouze<span class="token punctuation">.</span>wp_posts <span class="token keyword">WHERE</span> <span class="token keyword">Type</span> <span class="token operator">LIKE</span> <span class="token string">"text"</span><span class="token punctuation">;</span></code></pre></div>
<h3>Users</h3>
<h4>Utilisateur courant</h4>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token keyword">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token keyword">current_user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">+</span><span class="token comment">----------------+</span>
<span class="token operator">|</span> <span class="token keyword">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span>         <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------+</span>
<span class="token operator">|</span> root<span class="token variable">@localhost</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.001</span> sec<span class="token punctuation">)</span></code></pre></div>
<h4>Liste des utilisateurs de la BDD</h4>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">user</span><span class="token punctuation">,</span> host <span class="token keyword">FROM</span> mysql<span class="token punctuation">.</span><span class="token keyword">user</span><span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> <span class="token keyword">user</span><span class="token punctuation">,</span>
    host<span class="token punctuation">,</span>
    is_role<span class="token punctuation">,</span>
    password_expired<span class="token punctuation">,</span>
    Password
<span class="token keyword">FROM</span> mysql<span class="token punctuation">.</span><span class="token keyword">user</span><span class="token punctuation">;</span></code></pre></div>
<h3>Permissions</h3>
<p>Les Users sont crÃ©Ã©s de base sans aucun droits, c'est le <code class="language-text">GRANT USAGE</code> , cela leurs permets uniquement de se logger.</p>
<p>Pour checker les permissions du user avec lequel on s'est connectÃ©:</p>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">SHOW</span> GRANTS<span class="token punctuation">;</span>  <span class="token comment">-- Ã©quivalent Ã  SHOW GRANTS FOR CURRENT_USER; ou CURRENT_USER();</span></code></pre></div>
<p>Pour lister les users de la BDD (et avoir la combinaison <code class="language-text">user@host</code>) :</p>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">SHOW</span> GRANTS <span class="token keyword">FOR</span> le_user_a_checker<span class="token variable">@le_host</span><span class="token punctuation">;</span></code></pre></div>
<p>A noter qu'il est possible d'Ã©crire:</p>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token string">'username'</span><span class="token variable">@'hostname'</span>
<span class="token string">"username"</span><span class="token variable">@"hostname"</span>
<span class="token identifier"><span class="token punctuation">`</span>username<span class="token punctuation">`</span></span><span class="token variable">@`hostname`</span></code></pre></div>
<h3>Threads courants</h3>
<p>Les 2 commandes suivantes sont Ã©quivalentes:</p>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">SHOW</span> PROCESSLIST<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> id<span class="token punctuation">,</span>
    <span class="token keyword">user</span><span class="token punctuation">,</span>
    host<span class="token punctuation">,</span>
    db<span class="token punctuation">,</span>
    command<span class="token punctuation">,</span>
    <span class="token keyword">time</span><span class="token punctuation">,</span>
    State<span class="token punctuation">,</span>
    Info<span class="token punctuation">,</span>
    Progress
<span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span>processlist<span class="token punctuation">;</span></code></pre></div>
<h2>CrÃ©ations</h2>
<h3>User</h3>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">USER</span> <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> user_a_creer
IDENTIFIED <span class="token keyword">BY</span> <span class="token string">'password'</span><span class="token punctuation">;</span></code></pre></div>
<p><code class="language-text">user_a_creer</code> peut etre une combinaison <code class="language-text">nom_user@host</code> ou juste <code class="language-text">nom_user</code> auquel cas le host attribuÃ© est <code class="language-text">%</code> automatiquement. La partie host designe la machine depuis laquel ce user pourra se connecter, et <code class="language-text">%</code> signifie <em>depuis partout</em> (donc attention on permet les remote access) !</p>
<p>Pour modifier le mot de passe du user prÃ©cÃ©dement crÃ©Ã© :</p>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">ALTER</span> <span class="token keyword">USER</span> user_a_creer IDENTIFIED <span class="token keyword">BY</span> <span class="token string">'mon_nouveau_password'</span><span class="token punctuation">;</span></code></pre></div>
<p>â  <em>Attention</em> si on utilise la syntaxe <code class="language-text">IDENTIFIED BY PASSWORD</code> au lieu de <code class="language-text">IDENTIFIED BY</code>, le SGDBD s'attendra a recevoir un <a href="https://mariadb.com/kb/en/grant/#identified-by-password-password_hash">hash de password</a> que l'on obtiendra grÃ¢ce Ã  la fonction <a href="https://mariadb.com/kb/en/password/"><code class="language-text">PASSWORD</code></a> par un <code class="language-text">SELECT PASSWORD('mon_super_password');</code> ce qu'il nous fera comprendre par un message :</p>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql">ERROR <span class="token number">1372</span> <span class="token punctuation">(</span>HY000<span class="token punctuation">)</span>: Password <span class="token keyword">hash</span> should be a <span class="token number">41</span><span class="token operator">-</span>digit hexadecimal number</code></pre></div>
<h3>Permissions</h3>
<p>Une fois le User crÃ©Ã© il faut lui attribuer des droits pour qu'il puisse interagir avec la BDD.
Les permissions (ou droits) sont associÃ©s Ã  la <code class="language-text">database</code>, un <code class="language-text">table</code>, une routine, ou Ã  des <code class="language-text">columns</code> particuliÃ¨re d'une table.
L'attribution de ces droits se fait a l'aide de l'instruction <code class="language-text">GRANT</code>, et on <em>attribue le droit XXX sur l'Ã©lÃ©ment de BDD Ã  l'utilisateur nom_user</em> comme ceci :</p>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">GRANT</span> XXX 
<span class="token keyword">ON</span> la_bdd_voulue<span class="token punctuation">.</span><span class="token operator">*</span> 
<span class="token keyword">TO</span> nom_user<span class="token punctuation">;</span></code></pre></div>
<p>avec XXX le ou les <a href="https://mariadb.com/kb/en/grant/#table-privileges">privileges a attribuer</a>, avec les plus courants: <code class="language-text">ALL PRIVILEGES</code>, <code class="language-text">SELECT</code>, <code class="language-text">INSERT</code>, <code class="language-text">UPDATE</code>, <code class="language-text">DELETE</code>, <code class="language-text">INDEX</code>, <code class="language-text">GRANT OPTION</code></p>
et on vÃ©rifie les permissions attribuÃ©es avec un SHOW GRANTS FOR... voir <a href="/#permissions" title=""></a>
<h3>Permissions particuliÃ¨res</h3>
<h4>ALL PRIVILEGES</h4>
<p>avec la permission <code class="language-text">ALL PRIVILEGES</code> il nous est possible de toutes les attribuer (en dehors de <code class="language-text">GRANT OPTION</code>) en une fois :</p>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">GRANT</span> <span class="token keyword">ALL</span> <span class="token keyword">PRIVILEGES</span> <span class="token keyword">ON</span>  <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">to</span> <span class="token string">'nom_user'</span><span class="token variable">@'localhost'</span><span class="token punctuation">;</span></code></pre></div>
<h4>USAGE</h4>
<p>C'est la permission qui est attribuÃ©e par dÃ©faut Ã  la crÃ©ation d'un utilisateur</p>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql">MariaDB <span class="token punctuation">[</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">></span> <span class="token keyword">CREATE</span> <span class="token keyword">USER</span> toto IDENTIFIED <span class="token keyword">BY</span> <span class="token string">'mon_super_password'</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.007</span> sec<span class="token punctuation">)</span>

MariaDB <span class="token punctuation">[</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">></span> <span class="token keyword">SHOW</span> GRANTS <span class="token keyword">FOR</span> toto<span class="token variable">@'%'</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">--------------------------------------------------------+</span>
<span class="token operator">|</span> Grants <span class="token keyword">for</span> toto@<span class="token operator">%</span>                                                                                   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------------------------------------+</span>
<span class="token operator">|</span> <span class="token keyword">GRANT</span> <span class="token keyword">USAGE</span> <span class="token keyword">ON</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> <span class="token identifier"><span class="token punctuation">`</span>toto<span class="token punctuation">`</span></span><span class="token variable">@`%`</span> IDENTIFIED <span class="token keyword">BY</span> PASSWORD <span class="token string">'*A62D57DD7D1835DC24EE4D41B4400E32C40B46B6'</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------------------------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.001</span> sec<span class="token punctuation">)</span></code></pre></div>
<h4>GRANT OPTION</h4>
<p>Le privilÃ¨ge <code class="language-text">GRANT OPTION</code> qui attribut le droit de modifier les permissions (Ã  la hauteur des permission de l'utilisateur selectionnÃ©) n'est pas inclus dans le <code class="language-text">ALL PRIVILEGES</code>.</p>
<p>Pour attribuer ce droit particulier il faut complÃ©ter la requete prÃ©cÃ©dente ainsi :</p>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">GRANT</span> <span class="token keyword">ALL</span> <span class="token keyword">PRIVILEGES</span> <span class="token keyword">ON</span>  <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">to</span> <span class="token string">'nom_user'</span><span class="token variable">@'localhost'</span> <span class="token keyword">WITH</span> <span class="token keyword">GRANT</span> <span class="token keyword">OPTION</span><span class="token punctuation">;</span></code></pre></div>
<h2>Connexion distant</h2>
<p>Il faut tout d'abord disposer d'un client mysql : <code class="language-text">sudo apt install mariadb-client -y</code>
Pour autoriser les connexion distantes il faut intervenir sur la configuration rÃ©seau du serveur, dans la config mariadb et dans le paramÃ©trage de la base de donnÃ©es.
Une fois le client installÃ©, se connecter avec les credentials du user (crÃ©Ã© pour une connexion distante avec soit <code class="language-text">%</code> soit l'<code class="language-text">adresse IP</code> en tant que host):</p>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell">mysql -h host_name -u mon_user -p</code></pre></div>
<h3>config Serveur</h3>
<p>CotÃ© serveur vÃ©rifier que le port mariadb/mysql <code class="language-text">3306</code> (ou celui que vous aurez dÃ©fini dans <code class="language-text">/etc/mysql/mariadb.cnf</code>) est bien ouvert au niveau rÃ©seau :</p>
<ul>
<li>
vÃ©rifier les config du firewall local <a href="/ufw" title="ufw">ufw</a> ou iptables -L
</li>
<li>vÃ©rifier que mysql Ã©coute bien sur le port <code class="language-text">3306</code> avec un <code class="language-text">netstat -tupln</code></li>
</ul>
<h3>config mariadb</h3>
<p>autoriser les connexions distantes au daemon <code class="language-text">mariadbd</code> dans le fichier de config du serveur : <code class="language-text">/etc/mysql/mariadb.conf.d/50-server.cnf</code></p>
<div class="gatsby-highlight" data-language="cnf"><pre class="language-cnf"><code class="language-cnf">bind-address            = 127.0.0.1 # interdit les connexions distantes
bind-address            = 0.0.0.0   # autorise les connexions distantes</code></pre></div>
<p>redÃ©marrer le service :</p>
<div class="gatsby-highlight" data-language="shell"><pre class="language-shell"><code class="language-shell"><span class="token function">sudo</span> systemctl restart mariadb</code></pre></div>
<h3>config en BDD</h3>
<p>Attribuer les <a href="https://www.mysqltutorial.org/mysql-grant.aspx">droits</a> (pas forcÃ©ment <code class="language-text">ALL</code>) au couple <code class="language-text">username@host</code> Ã  l'entitÃ© de BDD souhaitÃ©e:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">GRANT ALL ON la_dbb.* to 'username'@'hostname' IDENTIFIED BY 'password'</code></pre></div>
<p>Le <code class="language-text">FLUSH PRIVILEGES</code> n'est pas nÃ©cessaire pour appliquer les modifs comme <a href="https://dev.mysql.com/doc/refman/8.0/en/privilege-changes.html">indiquÃ© dans la doc</a>.</p>
<h2>Astuces</h2>
<h4>Affichage en colonne</h4>
<p>Pour un affichage plus lisible, surtout lors d'un <code class="language-text">select *</code> mysql nous offre la possibilitÃ© d'afficher en mode colonne en finalisant la commande par <code class="language-text">\G;</code> :</p>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> mysql<span class="token punctuation">.</span><span class="token keyword">user</span> <span class="token keyword">WHERE</span> <span class="token keyword">User</span> <span class="token operator">LIKE</span> <span class="token string">'usr_%'</span> \G<span class="token punctuation">;</span></code></pre></div>
<h4>Mode interactif</h4>
<p><code class="language-text">CTRL + U</code> ou <code class="language-text">CTRL + w</code> supprime les caractÃ¨res prÃ©cÃ©dent le curseur, donc tout ce qui est a sa gauche
<code class="language-text">CTRL + K</code> idem pour les caratÃ¨res Ã  droite jusqu'Ã  la fin de ligne
<code class="language-text">CTRL + L</code> pour clear l'affichage</p>
<p>MariaDB possÃ¨de un ensemble de "<em>commandes</em>" exÃ©cutÃ©s dans une session interactive en saisissant par ex <code class="language-text">\? + ENTER</code>  pour obtenir l'accÃ¨s Ã  l'aide en ligne.</p>
<p>Les commandes intÃ©ressantes sont :
<code class="language-text">\G</code> affichage en colonne/vertical
<code class="language-text">\e</code> pour editer la commande courante dans l'<code class="language-text">$EDITOR</code>
<code class="language-text">\. script.sql</code> pour exÃ©cuter le script en argument
<code class="language-text">\s</code> status du serveur
<code class="language-text">\! cmd</code> execute une commande shell
<code class="language-text">\T fichier.log</code> permet de spÃ©cifier un fichier dans lequel toute la session sera loggÃ©e</p>
<h4>Historique</h4>
<p>l'historique des commandes exÃ©cutÃ©e en mode interactif est conservÃ© dans le fichier <code class="language-text">.mysql_history</code> situÃ© dans le home de l'utilisateur. Pour <a href="https://bugzilla.redhat.com/show_bug.cgi?id=1970829#c1">info</a> ce fichier est encodÃ©</p>
<blockquote>
<p>Please look at the ".mysql_history" file as file with a binary format, managed by the MariaDB or MySQL application</p>
</blockquote>
<p><code class="language-text">CTRL + R</code> nous permet de <strong>chercher dans l'historique</strong> des commandes passÃ©es.
Une fois cette combinaison de touche entrÃ©e, on entre dans le <a href="%60CTRL+R%60">mode <em>Recherche dans l'historique</em></a> de MySQL. La navigation s'effectue ensuite via <code class="language-text">CTRL + R</code> (ancien) et <code class="language-text">CTRL + S</code> (rÃ©cent).</p>
<h4>ExÃ©cution de script</h4>
<div class="gatsby-highlight" data-language="sql"><pre class="language-sql"><code class="language-sql">mysql db_name <span class="token operator">&lt;</span> script<span class="token punctuation">.</span><span class="token keyword">sql</span> <span class="token operator">></span> output<span class="token punctuation">.</span>tab</code></pre></div>
<p>voir toutes les <a href="https://mariadb.com/kb/en/mysql-command-line-client/#options">options de la CLI mysql</a></p>
<h4>Backup Ã  la barbare</h4>
<p>La carte micro-sd d'un de mes Raspberry Pie a lachÃ©, mais heureusement pour moi elle Ã©tait encore lisible (mais dead en Ã©criture).</p>
<p>Le backup Ã  la barbare consiste Ã  rÃ©cupÃ©rer le contenu du dossier <code class="language-text">/var/lib/mysql</code> sur la carte cramÃ©e puis sur le nouveau serveur (ayant une installation de mariadb) :</p>
<ul>
<li>arreter l'instance de mariadb avec <code class="language-text">sudo systemctl stop mariadb</code></li>
<li>remplacer le dossier <code class="language-text">/var/lib/mysql</code> local par celui de l'ancien serveur</li>
<li>supprimer les ib_logfiles  <code class="language-text">rm /var/lib/mysql/ib_logfile*</code>  sans quoi on aura des erreurs du type <code class="language-text">[ERROR] Unknown/unsupported storage engine: InnoDB</code> lors de l'accÃ¨s aux donnÃ©es</li>
<li><code class="language-text">sudo systemctl start mariadb</code></li>
</ul>
<h2>Liens</h2>
<ul>
<li><a href="https://www.mysqltutorial.org/mysql-administration">MySQLTutorial.org</a> site de tuto trÃ¨s clair ð avec de nombreux exemples</li>
<li><a href="https://dev.mysql.com/doc/">MySQL docs</a></li>
<li><a href="https://mariadb.com/kb/en/documentation/">MariaDB docs</a> (pas trÃ¨s ergonomique cette doc ðµ)</li>
</ul></div><style data-emotion="css iw22na">.css-iw22na{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.75;letter-spacing:0.00938em;color:#90a4ae;}</style><i class="MuiTypography-root MuiTypography-subtitle1 css-iw22na"><div><span>rÃ©digÃ© le 16/02/22<!-- --> </span>par <!-- -->Behrouze</div></i></div></main><footer><style data-emotion="css 1cksea9">.css-1cksea9{border-top:1px solid #90a4ae;margin:2rem 0;padding:1.5rem 0;}@media (min-width:0px){.css-1cksea9{display:none;}}@media (min-width:600px){.css-1cksea9{display:block;}}</style><div class="MuiBox-root css-1cksea9"><style data-emotion="css 1hq69am">.css-1hq69am{-webkit-text-decoration:none;text-decoration:none;margin-right:2rem;}</style><style data-emotion="css 1l5ulo5">.css-1l5ulo5{margin:0;color:#37474f;-webkit-text-decoration:none;text-decoration:none;margin-right:2rem;}</style><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineNone css-1l5ulo5" href="/linux-systemd"></a><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineNone css-1l5ulo5" href="/a-propos-contact">A propos</a><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineNone css-1l5ulo5" href="/cheat-sheets">Cheat Sheets</a><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineNone css-1l5ulo5" href="/tools">Outils</a><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineNone css-1l5ulo5" href="/must-see-videos">VidÃ©os</a></div></footer></main></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-29210389-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/mariadb-mysql";window.___webpackCompilationHash="6f4c2457d9e910b59e71";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-14d23f0c9fb58e155a8c.js"],"app":["/app-2522e8ee87ba4c5fd227.js"],"component---src-pages-404-js":["/component---src-pages-404-js-73ec88530ccbc327b9bd.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-92ce5a38e9b81cb2e7a7.js"],"component---src-templates-wp-page-tsx":["/component---src-templates-wp-page-tsx-695c0bd6e23b7d2e72e4.js"],"component---src-templates-wp-post-tsx":["/component---src-templates-wp-post-tsx-6bbc10329ef005f8184a.js"]};/*]]>*/</script><script src="/polyfill-14d23f0c9fb58e155a8c.js" nomodule=""></script><script src="/component---src-templates-wp-post-tsx-6bbc10329ef005f8184a.js" async=""></script><script src="/bd9a198b5f7fb6fa7f93111e3cc9693331ac2819-5c4a823133b536a699d8.js" async=""></script><script src="/commons-30350ba6450927006b33.js" async=""></script><script src="/app-2522e8ee87ba4c5fd227.js" async=""></script><script src="/framework-1b09f98392e3a984ace3.js" async=""></script><script src="/webpack-runtime-7d20d3cba42a18af62c0.js" async=""></script></body></html>